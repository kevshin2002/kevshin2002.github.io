(self.webpackChunkkevshin2002=self.webpackChunkkevshin2002||[]).push([[9864],{8294:(e,n,a)=>{e.exports={src:{srcSet:a.p+"assets/ideal-img/costmap.4abd661.407.jpg 407w",images:[{path:a.p+"assets/ideal-img/costmap.4abd661.407.jpg",width:407,height:213}],src:a.p+"assets/ideal-img/costmap.4abd661.407.jpg",toString:function(){return a.p+"assets/ideal-img/costmap.4abd661.407.jpg"},placeholder:void 0,width:407,height:213},preSrc:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAFCAIAAADzBuo/AAAACXBIWXMAAAsTAAALEwEAmpwYAAAApklEQVR4nAGbAGT/AODz/93x/tnu/eH0/9ru+oObnai0tMvS05Sjo4CYmQCSrrGguNG2xueYscOWs7Szv8Hy8vHx8fDp6eiSpKQAWnp7k6XMvbboe5CxZIiAyNHS4tvkwq3F3tHdorKyAJeytKO50LjI5ZiywKC6vY6joLSww4uQo3aJm4OWlwDg9P/e8v7Y7v3h9P/b7vqBmZlxiJB3kqZsgYmDm5wOuG0gTEFX4AAAAABJRU5ErkJggg=="}},8158:(e,n,a)=>{e.exports={src:{srcSet:a.p+"assets/ideal-img/multi.0169e29.500.jpg 500w,"+a.p+"assets/ideal-img/multi.1643453.1000.jpg 1000w,"+a.p+"assets/ideal-img/multi.2aeb843.1125.jpg 1125w",images:[{path:a.p+"assets/ideal-img/multi.0169e29.500.jpg",width:500,height:336},{path:a.p+"assets/ideal-img/multi.1643453.1000.jpg",width:1e3,height:673},{path:a.p+"assets/ideal-img/multi.2aeb843.1125.jpg",width:1125,height:757}],src:a.p+"assets/ideal-img/multi.0169e29.500.jpg",toString:function(){return a.p+"assets/ideal-img/multi.0169e29.500.jpg"},placeholder:void 0,width:500,height:336},preSrc:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAHCAIAAAC+zks0AAAACXBIWXMAAAsTAAALEwEAmpwYAAAA5ElEQVR4nAHZACb/AMPJ0tLY4dba5b3Cy77Ey9TY4L7Dy7W8xrO6w7zCywDj5OPw7+7y8fBNTEuIhYS+ubuppaeem5t+e3yQjo4A4ejw8/n98/Pyg4GEsp+uuq26vLm8u7a6uba4xsTHAOXr8vP5/Pn4+ca+wrmemsKwt7m2ubSxsqupq8vJywD+/v7////39/eyq7Cvq6u2s7WtqKy+ur2wra/OzM4A9/f3+/r7+/v7sa+ytrO3wb3As7Gzq6irp6SnzcvNANzc3ODg4Obl5sfGx8HAwdTT1NXS1dDP0M/Nz9LQ0chxoheE+/CtAAAAAElFTkSuQmCC"}},8564:(e,n,a)=>{e.exports={src:{srcSet:a.p+"assets/ideal-img/Mapped.b607ca7.500.jpg 500w,"+a.p+"assets/ideal-img/Mapped.a6b9e37.1000.jpg 1000w,"+a.p+"assets/ideal-img/Mapped.e496c85.1182.jpg 1182w",images:[{path:a.p+"assets/ideal-img/Mapped.b607ca7.500.jpg",width:500,height:335},{path:a.p+"assets/ideal-img/Mapped.a6b9e37.1000.jpg",width:1e3,height:671},{path:a.p+"assets/ideal-img/Mapped.e496c85.1182.jpg",width:1182,height:793}],src:a.p+"assets/ideal-img/Mapped.b607ca7.500.jpg",toString:function(){return a.p+"assets/ideal-img/Mapped.b607ca7.500.jpg"},placeholder:void 0,width:500,height:335},preSrc:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAHCAIAAAC+zks0AAAACXBIWXMAAAsTAAALEwEAmpwYAAAA5ElEQVR4nAHZACb/AL/Fz8zS3c3T3r3DzLvByb3Cyri+x8PJ1NPZ5Lq+yADo6Obx8O7x7+9UVFM0NTM6OjkvLy6dnZzx8O/U09IA6uvr9PX28PDwU1lZZm9vjZCSTVdWmpub////29zcAOjo5/r5+PDw8GNlZaWkpb67vYSFh52enf///+Li4gDP3eTf7fbd5uxdYmKak5TEwMN1fX2en5/////j5OQA5+np9vj57+/wRkhIMjQ0QkJCIicnmpqa////4+PjAOfm5uvq6+bl5pyam4uJio6NjoeFhsG/wPLy8tTS00m0lGgXkslXAAAAAElFTkSuQmCC"}},4627:(e,n,a)=>{e.exports={src:{srcSet:a.p+"assets/ideal-img/map.8d53cda.500.jpg 500w,"+a.p+"assets/ideal-img/map.0b192e6.1000.jpg 1000w,"+a.p+"assets/ideal-img/map.dbf6436.1179.jpg 1179w",images:[{path:a.p+"assets/ideal-img/map.8d53cda.500.jpg",width:500,height:336},{path:a.p+"assets/ideal-img/map.0b192e6.1000.jpg",width:1e3,height:672},{path:a.p+"assets/ideal-img/map.dbf6436.1179.jpg",width:1179,height:792}],src:a.p+"assets/ideal-img/map.8d53cda.500.jpg",toString:function(){return a.p+"assets/ideal-img/map.8d53cda.500.jpg"},placeholder:void 0,width:500,height:336},preSrc:"data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAHCAIAAAC+zks0AAAACXBIWXMAAAsTAAALEwEAmpwYAAAA5ElEQVR4nAHZACb/AMHI08/W4NLY473Ezrm+yLrAybe9x8bN2Nng67m+xwDr6ef49vTw7excW1pDSkhOV1U1NjWYl5bx7+/My8oA0t/o2Obu3ejtfYeHh46OnaOke4SEp6+u////19fXAOfq7Ofr7e7y83+LiouMjKKam1BaWp6goP///93d3QDq6un09PP19vZ3hoVbbm1RW1omJyeamZn////d3d0A7e3t9vf28fHxZnV0OURDKisqFxYWlZWV////3d3dAObl5uzr7OXk5aSlpo+Oj5OSk4uLi8C/wPLx89DPz6Fsk81oXwH4AAAAAElFTkSuQmCC"}},7568:(e,n,a)=>{"use strict";a.r(n),a.d(n,{assets:()=>E,contentTitle:()=>O,default:()=>B,frontMatter:()=>I,metadata:()=>r,toc:()=>G});const r=JSON.parse('{"id":"Robotics/ROS2/nav2","title":"Nav2","description":"Getting Started","source":"@site/docs/Robotics/ROS2/nav.mdx","sourceDirName":"Robotics/ROS2","slug":"/Robotics/ROS2/nav2","permalink":"/docs/Robotics/ROS2/nav2","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedAt":1736668800000,"sidebarPosition":1,"frontMatter":{"id":"nav2","title":"Nav2","hide_title":true,"sidebar_position":1,"last_update":{"date":"1/12/2025","author":"Kevin Shin"}},"sidebar":"noteSidebar","previous":{"title":"ROS2","permalink":"/docs/Robotics/ROS2/"},"next":{"title":"Perception","permalink":"/docs/Robotics/ROS2/perception"}}');var s=a(4848),o=a(8453),t=a(4627),i=a.n(t),l=a(8564),c=a.n(l);const d=a.p+"assets/medias/localization-ba3b88ba953cabc06080aaddf7e82f4f.mp4";var h=a(1470),_=a(9365);const m=a.p+"assets/medias/demo-1a40eff5b66c9b8d99e4117f6d3d9c8b.mp4";var p=a(8294),u=a.n(p);const g=a.p+"assets/medias/demo_costmap-e263c10361a19304df4873a088f45fc7.mp4";var x=a(8158),j=a.n(x);const b=a.p+"assets/medias/multipath-a8e31d065a983f13eba070422181dc6a.mp4";var v=a(2083),f=a(6540),y=a(5193),A=a(232),w=a(8635),k=a(2552),N=a(7859);const T=(0,a(2732).F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),z=f.forwardRef(((e,n)=>{let{className:a,variant:r,size:o,asChild:t=!1,...i}=e;const l=t?N.DX:"button";return(0,s.jsx)(l,{className:(0,k.cn)(T({variant:r,size:o,className:a})),ref:n,...i})}));z.displayName="Button";const C=f.createContext(null);function R(){const e=f.useContext(C);if(!e)throw new Error("useCarousel must be used within a <Carousel />");return e}const S=f.forwardRef(((e,n)=>{let{orientation:a="horizontal",opts:r,setApi:o,plugins:t,className:i,children:l,...c}=e;const[d,h]=(0,y.A)({...r,axis:"horizontal"===a?"x":"y"},t),[_,m]=f.useState(!1),[p,u]=f.useState(!1),g=f.useCallback((e=>{e&&(m(e.canScrollPrev()),u(e.canScrollNext()))}),[]),x=f.useCallback((()=>{h?.scrollPrev()}),[h]),j=f.useCallback((()=>{h?.scrollNext()}),[h]),b=f.useCallback((e=>{"ArrowLeft"===e.key?(e.preventDefault(),x()):"ArrowRight"===e.key&&(e.preventDefault(),j())}),[x,j]);return f.useEffect((()=>{h&&o&&o(h)}),[h,o]),f.useEffect((()=>{if(h)return g(h),h.on("reInit",g),h.on("select",g),()=>{h?.off("select",g)}}),[h,g]),(0,s.jsx)(C.Provider,{value:{carouselRef:d,api:h,opts:r,orientation:a||("y"===r?.axis?"vertical":"horizontal"),scrollPrev:x,scrollNext:j,canScrollPrev:_,canScrollNext:p},children:(0,s.jsx)("div",{ref:n,onKeyDownCapture:b,className:(0,k.cn)("relative",i),role:"region","aria-roledescription":"carousel",...c,children:l})})}));S.displayName="Carousel";const P=f.forwardRef(((e,n)=>{let{className:a,...r}=e;const{carouselRef:o,orientation:t}=R();return(0,s.jsx)("div",{ref:o,className:"overflow-hidden",children:(0,s.jsx)("div",{ref:n,className:(0,k.cn)("flex","horizontal"===t?"-ml-4":"-mt-4 flex-col",a),...r})})}));P.displayName="CarouselContent";const L=f.forwardRef(((e,n)=>{let{className:a,...r}=e;const{orientation:o}=R();return(0,s.jsx)("div",{ref:n,role:"group","aria-roledescription":"slide",className:(0,k.cn)("min-w-0 shrink-0 grow-0 basis-full","horizontal"===o?"pl-4":"pt-4",a),...r})}));L.displayName="CarouselItem";const D=f.forwardRef(((e,n)=>{let{className:a,variant:r="outline",size:o="icon",...t}=e;const{orientation:i,scrollPrev:l,canScrollPrev:c}=R();return(0,s.jsxs)(z,{ref:n,variant:r,size:o,className:(0,k.cn)("absolute  h-8 w-8 rounded-full","horizontal"===i?"-left-12 top-1/2 -translate-y-1/2":"-top-12 left-1/2 -translate-x-1/2 rotate-90",a),disabled:!c,onClick:l,...t,children:[(0,s.jsx)(A.A,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"sr-only",children:"Previous slide"})]})}));D.displayName="CarouselPrevious";const M=f.forwardRef(((e,n)=>{let{className:a,variant:r="outline",size:o="icon",...t}=e;const{orientation:i,scrollNext:l,canScrollNext:c}=R();return(0,s.jsxs)(z,{ref:n,variant:r,size:o,className:(0,k.cn)("absolute h-8 w-8 rounded-full","horizontal"===i?"-right-12 top-1/2 -translate-y-1/2":"-bottom-12 left-1/2 -translate-x-1/2 rotate-90",a),disabled:!c,onClick:l,...t,children:[(0,s.jsx)(w.A,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"sr-only",children:"Next slide"})]})}));M.displayName="CarouselNext";const I={id:"nav2",title:"Nav2",hide_title:!0,sidebar_position:1,last_update:{date:"1/12/2025",author:"Kevin Shin"}},O=void 0,E={},G=[{value:"<strong>Getting Started</strong>",id:"getting-started",level:2},{value:"<strong>Requirements</strong>",id:"requirements",level:3},{value:"<strong>Map</strong>",id:"map",level:2},{value:"<strong>Configuring Cartographer</strong>",id:"configuring-cartographer",level:3},{value:"<strong>setup.py</strong>",id:"setuppy",level:4},{value:"<strong>CMakeList</strong>",id:"cmakelist",level:4},{value:"<strong>Compilation</strong>",id:"compilation",level:4},{value:"<strong>Alternative Configurations</strong>",id:"alternative-configurations",level:3},{value:"<strong>Using Saved Map</strong>",id:"using-saved-map",level:3},{value:"<strong>Nav2 Lifecycle Manager</strong>",id:"nav2-lifecycle-manager",level:2},{value:"<strong>Lifecycle Manager</strong>",id:"lifecycle-manager",level:4},{value:"<strong>Localization</strong>",id:"localization",level:2},{value:"<strong>ROS2 Localization</strong>",id:"ros2-localization",level:3},{value:"<strong>For Python</strong>",id:"for-python",level:4},{value:"<strong>For C++</strong>",id:"for-c",level:4},{value:"<strong>Auto Localization</strong>",id:"auto-localization",level:3},{value:"<strong>Via YAML</strong>",id:"via-yaml",level:4},{value:"<strong>Via CLI</strong>",id:"via-cli",level:4},{value:"<strong>Global Localization</strong>",id:"global-localization",level:3},{value:"<strong>Path Planning</strong>",id:"path-planning",level:2},{value:"<strong>Mapping Environment</strong>",id:"mapping-environment",level:5},{value:"<strong>Path Planning</strong>",id:"path-planning-1",level:5},{value:"<strong>nav2_yaml</strong>",id:"nav2_yaml",level:5},{value:"<strong>controller_yaml</strong>",id:"controller_yaml",level:5},{value:"<strong>bt_navigator_yaml</strong>",id:"bt_navigator_yaml",level:5},{value:"<strong>recovery_yaml</strong>",id:"recovery_yaml",level:5},{value:"<strong>Demo</strong>",id:"demo",level:3},{value:"<strong>RVIZ2 Settings</strong>",id:"rviz2-settings",level:4},{value:"<strong>Navigation Goal via CLI</strong>",id:"navigation-goal-via-cli",level:4},{value:"<strong>Obstacle Avoidance</strong>",id:"obstacle-avoidance",level:2},{value:"<strong>Costmaps</strong>",id:"costmaps",level:3},{value:"<strong>Global Costmaps</strong>",id:"global-costmaps",level:3},{value:"<strong>Global Costmap Obstacle Layers</strong>",id:"global-costmap-obstacle-layers",level:4},{value:"<strong>General Parameters</strong>",id:"general-parameters",level:4},{value:"<strong>Local Costmap</strong>",id:"local-costmap",level:3},{value:"<strong>Demo</strong>",id:"demo-1",level:3},{value:"<strong>Path Planner Package</strong>",id:"path-planner-package",level:3},{value:"<strong>Multi-robot Navigation</strong>",id:"multi-robot-navigation",level:2},{value:"<strong>Configuration</strong>",id:"configuration",level:3},{value:"<strong>Mapping</strong>",id:"mapping",level:3},{value:"<strong>Multirobot cartographer</strong>",id:"multirobot-cartographer",level:4},{value:"<strong>Configuring RVIZ2</strong>",id:"configuring-rviz2",level:4},{value:"<strong>Path Planning</strong>",id:"path-planning-2",level:3},{value:"<strong>Configuring RVIZ2</strong>",id:"configuring-rviz2-1",level:3},{value:"<strong>Single Launch</strong>",id:"single-launch",level:3}];function H(e){const n={a:"a",admonition:"admonition",annotation:"annotation",code:"code",h2:"h2",h3:"h3",h4:"h4",h5:"h5",img:"img",li:"li",math:"math",mi:"mi",mo:"mo",mrow:"mrow",ol:"ol",p:"p",pre:"pre",semantics:"semantics",span:"span",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h2,{id:"getting-started",children:(0,s.jsx)(n.strong,{children:"Getting Started"})}),"\n",(0,s.jsxs)(n.p,{children:["These are my notes from the ROS2 Navigation course available on ",(0,s.jsx)(n.a,{href:"https://app.theconstruct.ai",children:"The Construct"}),". As this is a robotics note, you will need physical hardware components to follow along. Before each section though, I will list what is required before starting."]}),"\n",(0,s.jsx)(n.h3,{id:"requirements",children:(0,s.jsx)(n.strong,{children:"Requirements"})}),"\n",(0,s.jsx)(n.p,{children:"Before starting, we need a robot with LIDAR and Odometry. We also need to use SLAM for localizing. Available ones are cartographer and SLAM-Toolbox. This note uses cartographer as the learning curve is lower. It is notable that cartographer is no longer maintained, so the better software to use is SLAM-Toolbox."}),"\n",(0,s.jsx)(n.p,{children:"Cartographer is a system that provides real-time simultaneous localization and mapping (SLAM) in both 2D and 3D across multiple platforms and sensor configurations. Cartographer_ros is a ROS wrapper of cartographer so that we can integrate cartographer with ROS. This allows us to use prebuilt packages and only have to configure them."}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://google-cartographer-ros.readthedocs.io/en/latest/_images/demo_2d.gif",alt:"cartographer_2d"})}),"\n",(0,s.jsx)(n.h2,{id:"map",children:(0,s.jsx)(n.strong,{children:"Map"})}),"\n",(0,s.jsx)(n.p,{children:"A map is a representation of the environment that the robot is functioning in. It uses the map to localize and plan trajectories. Maps are implemented in ROS2 via an occupancy grid where in each cell, specific values represent obstacles."}),"\n",(0,s.jsx)(n.h3,{id:"configuring-cartographer",children:(0,s.jsx)(n.strong,{children:"Configuring Cartographer"})}),"\n",(0,s.jsx)(n.p,{children:"We use a launch file because we can start multiple nodes and can also set a node-specific parameter while launching a node. These parameters can then be loaded from a YAML file or specified in the launch file."}),"\n",(0,s.jsxs)(n.p,{children:["To launch ",(0,s.jsx)(n.code,{children:"cartographer"}),", we need to launch two nodes. Below are the files you need within their respective directories."]}),"\n",(0,s.jsxs)(h.A,{children:[(0,s.jsxs)(_.A,{label:"cartographer.launch.py",value:"cartographer.launch.py",children:[(0,s.jsx)(n.p,{children:(0,s.jsx)(n.code,{children:"<package>/launch"})}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-py",children:"import os\nfrom ament_index_python.packages import get_package_share_directory\n\ncartographer_config_dir = os.path.join(get_package_share_directory('cartographer_slam'), 'config')\n\nNode(\npackage='cartographer_ros',\nexecutable='cartographer_node',\nname='cartographer_node',\noutput='screen',\nparameters=[{'use_sim_time': True}], # boolean indicating node synchronization time with simulation time\narguments=['-configuration_directory', cartographer_config_dir,\n'-configuration_basename', configuration_basename] # configuration_directory specifies where the configuration files are # configuration_basename specifies the configuration file name\n),\nNode(\npackage='cartographer_ros',\nexecutable='cartographer_occupancy_grid_node',\noutput='screen',\nname='occupancy_grid_node',\nparameters=[{'use_sim_time': True}],\narguments=['-resolution', '0.05', '-publish_period_sec', '1.0'] # resolution specifies number of meters per grid in the map # publish_period_sec specifies frequency of publishing to /map topic\n)\n\n"})})]}),(0,s.jsxs)(_.A,{label:"cartographer.lua",value:"cartographer.lua",children:[(0,s.jsxs)(n.p,{children:["We then create a LUA file named ",(0,s.jsx)(n.code,{children:"cartographer.lua"})," within the ",(0,s.jsx)(n.code,{children:"<package>/config"})," directory."]}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-lua",children:'include "map_builder.lua"\ninclude "trajectory_builder.lua"\n\noptions = {\n  map_builder = MAP_BUILDER,\n  trajectory_builder = TRAJECTORY_BUILDER,\n  map_frame = "map",\n  tracking_frame = "base_footprint",\n  published_frame = "odom",\n  odom_frame = "odom",\n  provide_odom_frame = false,\n  publish_frame_projected_to_2d = true,\n  use_odometry = true,\n  use_nav_sat = false,\n  use_landmarks = false,\n  num_laser_scans = 1,\n  num_multi_echo_laser_scans = 0,\n  num_subdivisions_per_laser_scan = 1,\n  num_point_clouds = 0,\n  lookup_transform_timeout_sec = 0.2,\n  submap_publish_period_sec = 0.3,\n  pose_publish_period_sec = 5e-3,\n  trajectory_publish_period_sec = 30e-3,\n  rangefinder_sampling_ratio = 1.,\n  odometry_sampling_ratio = 1.,\n  fixed_frame_pose_sampling_ratio = 1.,\n  imu_sampling_ratio = 1.,\n  landmarks_sampling_ratio = 1.,\n}\n\nMAP_BUILDER.use_trajectory_builder_2d = true\n\nTRAJECTORY_BUILDER_2D.min_range = 0.12\nTRAJECTORY_BUILDER_2D.max_range = 3.5\nTRAJECTORY_BUILDER_2D.missing_data_ray_length = 3.0\nTRAJECTORY_BUILDER_2D.use_imu_data = false\nTRAJECTORY_BUILDER_2D.use_online_correlative_scan_matching = true\nTRAJECTORY_BUILDER_2D.motion_filter.max_angle_radians = math.rad(0.1)\n\nPOSE_GRAPH.constraint_builder.min_score = 0.65\nPOSE_GRAPH.constraint_builder.global_localization_min_score = 0.7\n\n-- POSE_GRAPH.optimize_every_n_nodes = 0\n\nreturn options\n'})})]}),(0,s.jsxs)(_.A,{label:"config files",value:"config files",children:[(0,s.jsx)(n.p,{children:"Make sure that within setup.py, we specify the new config and lua directories. If you're using C++, make sure to specify the DIRECTORIES within CMakeList."}),(0,s.jsx)(n.h4,{id:"setuppy",children:(0,s.jsx)(n.strong,{children:"setup.py"})}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-py",children:"(os.path.join('share', package_name, 'launch'), glob('launch/*.launch.py')),\n(os.path.join('share', package_name, 'config'), glob('config/*')),\n"})}),(0,s.jsx)(n.h4,{id:"cmakelist",children:(0,s.jsx)(n.strong,{children:"CMakeList"})}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-cpp",children:"install(DIRECTORY\n    launch\n    config\n    DESTINATION share/${PROJECT_NAME}/\n)\n"})})]})]}),"\n",(0,s.jsx)(n.h4,{id:"compilation",children:(0,s.jsx)(n.strong,{children:"Compilation"})}),"\n",(0,s.jsx)(n.p,{children:"Compile the package and launch the launch file from the CLI. Once we've done that, run RVIZ2 on another terminal while our cartographer node is running."}),"\n",(0,s.jsxs)(n.p,{children:["To display our mapping, add the ",(0,s.jsx)(n.code,{children:"map"})," display and set the topic to ",(0,s.jsx)(n.code,{children:"/map"}),". If the mapping isn't showing, then the Quality of Service (QoS) parameters of the ",(0,s.jsx)(n.code,{children:"/map"})," may be wrong. We can add a couple more displays."]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"TF"}),": Allows us to see the frames of the robot"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"LaserScan"}),": Allows us to see the laser coliding with the objects on the map"]}),"\n"]}),"\n",(0,s.jsx)(n.admonition,{type:"note",children:(0,s.jsx)(n.p,{children:"These are all specific to the hardware configurations and the topic may be dependent on your system."})}),"\n",(0,s.jsxs)(S,{orientation:"horizontal",children:[(0,s.jsxs)(P,{children:[(0,s.jsx)(L,{children:(0,s.jsx)("img",{src:i().src,width:"100%"})}),(0,s.jsx)(L,{children:(0,s.jsx)("img",{src:c().src,width:"100%"})})]}),(0,s.jsx)(D,{}),(0,s.jsx)(M,{})]}),"\n",(0,s.jsx)(n.h3,{id:"alternative-configurations",children:(0,s.jsx)(n.strong,{children:"Alternative Configurations"})}),"\n",(0,s.jsxs)(n.p,{children:["Cartographer works for many robots and sensors but must be configured properly to work optimally. By default, cartographer automatically subscribes to ",(0,s.jsx)(n.code,{children:"/scan, /odom, /imu"})," topics. All configurations can be given from the Lua configuration file. This means that in the launch files, we have to remap those three if we want to publish data to them."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-py",children:"from launch import LaunchDescription\nfrom launch_ros.actions import Node\n\ndef generate_launch_description():\n    return LaunchDescription([\n        Node(\n            package='cartographer_ros',\n            executable='cartographer_node',\n            name='cartographer',\n            remappings=[\n                ('/scan', '/my_laser_scan'),\n                ('/odom', '/my_odom'),\n                ('/imu', '/my_imu')\n            ]\n        )\n    ])\n"})}),"\n",(0,s.jsxs)(v.XI,{children:[(0,s.jsx)(v.r6,{children:(0,s.jsx)(n.p,{children:"A list of configuration parameters and their details for cartographer"})}),(0,s.jsx)(v.A0,{children:(0,s.jsxs)(v.Hj,{children:[(0,s.jsx)(v.nd,{className:"w-[150px]",children:"Category"}),(0,s.jsx)(v.nd,{children:"Parameter"}),(0,s.jsx)(v.nd,{children:"Description"}),(0,s.jsx)(v.nd,{className:"text-right",children:"Default"})]})}),(0,s.jsxs)(v.BF,{children:[(0,s.jsxs)(v.Hj,{children:[(0,s.jsx)(v.nA,{className:"font-medium",children:"Frames"}),(0,s.jsx)(v.nA,{children:"map_frame"}),(0,s.jsx)(v.nA,{children:(0,s.jsx)(n.p,{children:"ROS frame ID for publishing sub-maps, the parent frame of poses."})}),(0,s.jsx)(v.nA,{className:"text-right",children:"map"})]}),(0,s.jsxs)(v.Hj,{children:[(0,s.jsx)(v.nA,{}),(0,s.jsx)(v.nA,{children:"tracking_frame"}),(0,s.jsx)(v.nA,{children:(0,s.jsxs)(n.p,{children:["Frame ID tracked by SLAM. IMU position if used, commonly ",(0,s.jsx)(n.code,{children:"base_link"})," or\n",(0,s.jsx)(n.code,{children:"base_footprint"}),"."]})}),(0,s.jsx)(v.nA,{className:"text-right",children:"base_link"})]}),(0,s.jsxs)(v.Hj,{children:[(0,s.jsx)(v.nA,{}),(0,s.jsx)(v.nA,{children:"published_frame"}),(0,s.jsx)(v.nA,{children:(0,s.jsxs)(n.p,{children:["Child frame for publishing poses. If ",(0,s.jsx)(n.code,{children:"odom"})," provided, it publishes pose\nof ",(0,s.jsx)(n.code,{children:"odom"})," in ",(0,s.jsx)(n.code,{children:"map_frame"}),"."]})}),(0,s.jsx)(v.nA,{className:"text-right",children:"odom or base_link"})]}),(0,s.jsxs)(v.Hj,{children:[(0,s.jsx)(v.nA,{}),(0,s.jsx)(v.nA,{children:"odom_frame"}),(0,s.jsx)(v.nA,{children:(0,s.jsxs)(n.p,{children:["Frame for publishing local SLAM result if ",(0,s.jsx)(n.code,{children:"provide_odom_frame"})," is true."]})}),(0,s.jsx)(v.nA,{className:"text-right",children:"odom"})]}),(0,s.jsxs)(v.Hj,{children:[(0,s.jsx)(v.nA,{}),(0,s.jsx)(v.nA,{children:"provide_odom_frame"}),(0,s.jsx)(v.nA,{children:(0,s.jsxs)(n.p,{children:["Publishes local non-loop-closed pose as ",(0,s.jsx)(n.code,{children:"odom_frame"})," in ",(0,s.jsx)(n.code,{children:"map_frame"})," if\nenabled."]})}),(0,s.jsx)(v.nA,{className:"text-right",children:"true"})]}),(0,s.jsxs)(v.Hj,{children:[(0,s.jsx)(v.nA,{}),(0,s.jsx)(v.nA,{children:"use_odometry"}),(0,s.jsx)(v.nA,{children:(0,s.jsxs)(n.p,{children:["Subscribes to ",(0,s.jsx)(n.code,{children:"nav_msgs/Odometry"})," on ",(0,s.jsx)(n.code,{children:"odom"})," topic and includes odometry\nin SLAM."]})}),(0,s.jsx)(v.nA,{className:"text-right",children:"true"})]}),(0,s.jsxs)(v.Hj,{children:[(0,s.jsx)(v.nA,{}),(0,s.jsx)(v.nA,{children:"use_nav_sat"}),(0,s.jsx)(v.nA,{children:(0,s.jsxs)(n.p,{children:["Subscribes to ",(0,s.jsx)(n.code,{children:"sensor_msgs/NavSatFix"})," on ",(0,s.jsx)(n.code,{children:"fix"})," topic and includes\nnavigation data in SLAM."]})}),(0,s.jsx)(v.nA,{className:"text-right",children:"true"})]}),(0,s.jsxs)(v.Hj,{children:[(0,s.jsx)(v.nA,{className:"font-medium",children:"Laser Parameters"}),(0,s.jsx)(v.nA,{children:"num_laser_scans"}),(0,s.jsx)(v.nA,{children:"Number of laser scan topics to subscribe to."}),(0,s.jsx)(v.nA,{className:"text-right",children:"1"})]}),(0,s.jsxs)(v.Hj,{children:[(0,s.jsx)(v.nA,{}),(0,s.jsx)(v.nA,{children:"num_multi_echo_laser_scans"}),(0,s.jsx)(v.nA,{children:(0,s.jsx)(n.p,{children:"Number of multi-echo laser scan topics to subscribe to."})}),(0,s.jsx)(v.nA,{className:"text-right",children:"0"})]}),(0,s.jsxs)(v.Hj,{children:[(0,s.jsx)(v.nA,{}),(0,s.jsx)(v.nA,{children:"num_subdivisions_per_laser_scan"}),(0,s.jsx)(v.nA,{children:(0,s.jsx)(n.p,{children:"Number of point clouds to split each laser scan for unwarping during\nmotion."})}),(0,s.jsx)(v.nA,{className:"text-right",children:"1"})]}),(0,s.jsxs)(v.Hj,{children:[(0,s.jsx)(v.nA,{}),(0,s.jsx)(v.nA,{children:"num_point_clouds"}),(0,s.jsx)(v.nA,{children:"Number of point cloud topics to subscribe to."}),(0,s.jsx)(v.nA,{className:"text-right",children:"1"})]}),(0,s.jsxs)(v.Hj,{children:[(0,s.jsx)(v.nA,{className:"font-medium",children:"Filter Parameters"}),(0,s.jsx)(v.nA,{children:"lookup_transform_timeout_sec"}),(0,s.jsx)(v.nA,{children:(0,s.jsx)(n.p,{children:"Timeout in seconds for looking up transforms using tf2."})}),(0,s.jsx)(v.nA,{className:"text-right",children:"0.2"})]}),(0,s.jsxs)(v.Hj,{children:[(0,s.jsx)(v.nA,{}),(0,s.jsx)(v.nA,{children:"submap_publish_period_sec"}),(0,s.jsx)(v.nA,{children:"Interval in seconds to publish submap poses."}),(0,s.jsx)(v.nA,{className:"text-right",children:"0.3"})]}),(0,s.jsxs)(v.Hj,{children:[(0,s.jsx)(v.nA,{}),(0,s.jsx)(v.nA,{children:"pose_publish_period_sec"}),(0,s.jsx)(v.nA,{children:(0,s.jsx)(n.p,{children:"Interval in seconds to publish poses (e.g., 5e-3 for 200 Hz)."})}),(0,s.jsx)(v.nA,{className:"text-right",children:"5e-3"})]}),(0,s.jsxs)(v.Hj,{children:[(0,s.jsx)(v.nA,{}),(0,s.jsx)(v.nA,{children:"trajectory_publish_period_sec"}),(0,s.jsx)(v.nA,{children:(0,s.jsx)(n.p,{children:"Interval in seconds to publish trajectory markers (e.g., 30e-3 for 30\nms)."})}),(0,s.jsx)(v.nA,{className:"text-right",children:"30e-3"})]}),(0,s.jsxs)(v.Hj,{children:[(0,s.jsx)(v.nA,{}),(0,s.jsx)(v.nA,{children:"odometry_sampling_ratio"}),(0,s.jsx)(v.nA,{children:"Sampling ratio for odometry messages."}),(0,s.jsx)(v.nA,{className:"text-right",children:"1.0"})]}),(0,s.jsxs)(v.Hj,{children:[(0,s.jsx)(v.nA,{}),(0,s.jsx)(v.nA,{children:"fixed_frame_sampling_ratio"}),(0,s.jsx)(v.nA,{children:"Sampling ratio for fixed frame messages."}),(0,s.jsx)(v.nA,{className:"text-right",children:"1.0"})]}),(0,s.jsxs)(v.Hj,{children:[(0,s.jsx)(v.nA,{}),(0,s.jsx)(v.nA,{children:"imu_sampling_ratio"}),(0,s.jsx)(v.nA,{children:"Sampling ratio for IMU messages."}),(0,s.jsx)(v.nA,{className:"text-right",children:"1.0"})]}),(0,s.jsxs)(v.Hj,{children:[(0,s.jsx)(v.nA,{}),(0,s.jsx)(v.nA,{children:"landmarks_sampling_ratio"}),(0,s.jsx)(v.nA,{children:"Sampling ratio for landmark messages."}),(0,s.jsx)(v.nA,{className:"text-right",children:"1.0"})]}),(0,s.jsxs)(v.Hj,{children:[(0,s.jsx)(v.nA,{className:"font-medium",children:"Trajectory Builder"}),(0,s.jsx)(v.nA,{children:"TRAJECTORY_BUILDER_2D.min_range"}),(0,s.jsx)(v.nA,{children:(0,s.jsx)(n.p,{children:"Minimum distance measured to be considered for mapping."})}),(0,s.jsx)(v.nA,{className:"text-right",children:"0.2"})]}),(0,s.jsxs)(v.Hj,{children:[(0,s.jsx)(v.nA,{}),(0,s.jsx)(v.nA,{children:"TRAJECTORY_BUILDER_2D.max_range"}),(0,s.jsx)(v.nA,{children:(0,s.jsx)(n.p,{children:"Maximum distance measured to be considered for mapping."})}),(0,s.jsx)(v.nA,{className:"text-right",children:"30.0"})]}),(0,s.jsxs)(v.Hj,{children:[(0,s.jsx)(v.nA,{}),(0,s.jsx)(v.nA,{children:"TRAJECTORY_BUILDER_2D.missing_data_ray_length"}),(0,s.jsx)(v.nA,{children:"Distance to treat as a lost laser ray."}),(0,s.jsx)(v.nA,{className:"text-right",children:"25.0"})]}),(0,s.jsxs)(v.Hj,{children:[(0,s.jsx)(v.nA,{}),(0,s.jsx)(v.nA,{children:"TRAJECTORY_BUILDER_2D.use_imu_data"}),(0,s.jsx)(v.nA,{children:"Whether or not to use IMU data."}),(0,s.jsx)(v.nA,{className:"text-right",children:"true"})]})]})]}),"\n",(0,s.jsxs)(n.p,{children:["If we want to save the map that we mapped out, we can run an executable named ",(0,s.jsx)(n.code,{children:"map_saver"})," from ",(0,s.jsx)(n.code,{children:"nav2_map_server"}),". It's important that we call this within the directory that we want to save the map in. The cartography has to be running for this to work."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"ros2 run nav2_map_server map_saver_cli -f <name>\n"})}),"\n",(0,s.jsxs)(n.p,{children:["This'll generate two files of type ",(0,s.jsx)(n.code,{children:".pgm"})," and ",(0,s.jsx)(n.code,{children:".yaml"}),". The ",(0,s.jsx)(n.code,{children:".pgm"})," is an image file of the map as an occupancy grid image. The ",(0,s.jsx)(n.code,{children:".yaml"})," contains details about the resolution of the map."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"image: turtlebot_area.pgm\nmode: trinary\nresolution: 0.05 # Resolution of the map (meters/pixel)\norigin: [-3.8, -1.84, 0] # Coordinates of the lower-left pixel on the map (x,y,z). The third value indicates rotation and if there is none, value is 0\nnegate: 0 # Inverts the color of the map.\noccupied_thresh: 0.65 # Pixels with a value greater than this value will be considered an occupied zone\nfree_thresh: 0.25 # Pixels with a value smaller than this will be considered a completely free zone\n"})}),"\n",(0,s.jsx)(n.h3,{id:"using-saved-map",children:(0,s.jsx)(n.strong,{children:"Using Saved Map"})}),"\n",(0,s.jsxs)(n.p,{children:["If we want to use the saved map, we have to launch ",(0,s.jsx)(n.code,{children:"map_server"})," and ",(0,s.jsx)(n.code,{children:"nav2_lifecycle_manager"}),". We can create a custom launch file for this, but we must specify some parameters."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-py",children:"from launch import LaunchDescription\nfrom launch_ros.actions import Node\nfrmo ament_index_python.packages import get_package_share_directory\nimport os\n\ndef generate_launch_description():\n    map_file = os.path.join(get_package_share_directory('map_server'), 'config', 'turtlebot_area.yaml')\n    return LaunchDescription([\n        Node(\n            package=\"nav2_map_server\",\n            executable=\"map_server\",\n            name=\"map_server\",\n            output=\"screen\",\n            parameters=[{'use_sim_time': True}, # Boolean indicating if map_server must synchronize with its time with the simulation\n                        {'yaml_filename':map_file] # The complete path to the map yaml file\n            ),\n        Node(\n            package=\"nav2_lifecycle_manager\",\n            executable=\"lifecycle_manager\",\n            name=\"lifecycle_manager_mapper\",\n            output=\"screen\",\n            parameters=[{'use_sim_time': True},\n                        {'autostart': True}, # lifecycle manager autostart when launched\n                        {'node_names':  ['map_server']}] # Nodes that the lifecycle manager takes care of\n            )\n        ])\n"})}),"\n",(0,s.jsx)(n.p,{children:"We can try using our saved map by creating a ROS2 package called map_server, placing our saved map files inside of config, and creating our launch file. Note that we can just put our launch file in any package and just create a new launch file with our configs."}),"\n",(0,s.jsx)(n.admonition,{type:"info",children:(0,s.jsx)(n.p,{children:"You must specify your map display durability as Transient Local. Volatile means use incoming data being published as the map source, while transient local allows us to check if we had any cached messages that were published but not received by our subscriber as well as all incoming data."})}),"\n",(0,s.jsx)(n.h2,{id:"nav2-lifecycle-manager",children:(0,s.jsx)(n.strong,{children:"Nav2 Lifecycle Manager"})}),"\n",(0,s.jsx)(n.p,{children:"Navigation nodes are managed nodes meaning that they can be easily controlled to be restarted, paused, or running. They can do so by being at these states:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Unconfigured"}),"\n",(0,s.jsx)(n.li,{children:"Inactive"}),"\n",(0,s.jsx)(n.li,{children:"Active"}),"\n",(0,s.jsx)(n.li,{children:"Finalized"}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["The diagram is taken from the course and depicts how nodes transition from one state to another. Seems to be like a state machine.\n",(0,s.jsx)(n.img,{src:"https://s3.eu-west-1.amazonaws.com/notebooks.ws/ros2-navigation-humble-148/images/lifecycle.png",alt:"Node Transition"})]}),"\n",(0,s.jsxs)(n.p,{children:["Managed nodes start at the ",(0,s.jsx)(n.code,{children:"unconfigured"})," state and is active usually when running. To transition to ",(0,s.jsx)(n.code,{children:"active"}),", nodes need an external agent that moves them to this state. Several nodes in Nav2, such as ",(0,s.jsx)(n.code,{children:"map_server"}),", ",(0,s.jsx)(n.code,{children:"amcl"}),", ",(0,s.jsx)(n.code,{children:"planner_server"}),", and ",(0,s.jsx)(n.code,{children:"controller_server"}),", are lifecycle enabled meaning they are managed nodes."]}),"\n",(0,s.jsx)(n.p,{children:"These nodes have the required overrides of the lifecycle functions:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"on_configure()"}),"\n",(0,s.jsx)(n.li,{children:"on_activate()"}),"\n",(0,s.jsx)(n.li,{children:"on_deactivate()"}),"\n",(0,s.jsx)(n.li,{children:"on_cleanup()"}),"\n",(0,s.jsx)(n.li,{children:"on_shutdown()"}),"\n",(0,s.jsx)(n.li,{children:"on_error()"}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"lifecycle-manager",children:(0,s.jsx)(n.strong,{children:"Lifecycle Manager"})}),"\n",(0,s.jsxs)(n.p,{children:["In Nav2, the external agent that helps transition nodes to an active state is called the ",(0,s.jsx)(n.code,{children:"nav2_lifecycle_manager"}),". The lifecycle manager changes the state of the managed nodes to achieve a controlled startup, shutdown, reset, pause, or resume of the navigation stack."]}),"\n",(0,s.jsx)(n.p,{children:"Referenced from Steve Macenski"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://s3.eu-west-1.amazonaws.com/notebooks.ws/ros2-navigation-humble-148/images/diagram_lifecycle_manager.png",alt:"Figure"})}),"\n",(0,s.jsxs)(n.p,{children:["Nav2 uses a wrapper of ",(0,s.jsx)(n.code,{children:"LifecycleNode"}),", the ",(0,s.jsx)(n.code,{children:"nav2_util LifecycleNode"})," and it hides many abstractions of LifecycleNodes for typical applications. It includes a bond connection for the ",(0,s.jsx)(n.code,{children:"lifecycle manager"})," to ensure that after a node transitions up, it also remains active. When a node crashes, it lets the ",(0,s.jsx)(n.code,{children:"lifecycle manager"})," know and transitions down the system to prevent a critical failure."]}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"nav2_lifecycle_manager"})," provides a ROS service from which other ROS nodes can invoke the startup, shutdown, reset, pause, or resume functions. Based on these requests, the ",(0,s.jsx)(n.code,{children:"nav2_lifecycle_manager"})," calls the necessary lifecycle services in the managed nodes. As shown previously in the ",(0,s.jsx)(n.code,{children:"nav2_lifecycle_manager"})," node within the launch file, we specify which nodes need management via ",(0,s.jsx)(n.code,{children:"node_names"}),". The ordering matters as that is the order in which they have to be moved to initialized (first to last) and the order in which they are paused and stopped (last to first)."]}),"\n",(0,s.jsxs)(n.p,{children:["It's important that the manager has the ",(0,s.jsx)(n.code,{children:"autostart"})," parameter which allows the ",(0,s.jsx)(n.code,{children:"nav2_lifecycle_manager"})," to do it's default behavior."]}),"\n",(0,s.jsxs)(n.p,{children:["You interact with the ",(0,s.jsx)(n.code,{children:"nav2_lifecycle_manager"})," via a service named:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'/<lifecycle_manager_node_name>/manage_nodes\n\nros2 service call /lifecycle_manager/manage_nodes nav2_msgs/srv/ManageLifecycleNodes "{command: 0}" # Start the nodes\nros2 service call /lifecycle_manager/manage_nodes nav2_msgs/srv/ManageLifecycleNodes "{command: 1}" # Pause the nodes\nros2 service call /lifecycle_manager/manage_nodes nav2_msgs/srv/ManageLifecycleNodes "{command: 2}" # Resume the nodes\nros2 service call /lifecycle_manager/manage_nodes nav2_msgs/srv/ManageLifecycleNodes "{command: 3}" # Reset the nodes\nros2 service call /lifecycle_manager/manage_nodes nav2_msgs/srv/ManageLifecycleNodes "{command: 4}" # Shutdown the nodes\n'})}),"\n",(0,s.jsxs)(n.p,{children:["This is because the service ",(0,s.jsx)(n.code,{children:"/manage_nodes"})," uses the message ",(0,s.jsx)(n.code,{children:"nav2_msgs/srv/ManageLifecycleNodes"})," which is as follows:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-txt",children:"uint8 STARTUP = 0\nuint8 PAUSE = 1\nuint8 RESUME = 2\nuint8 RESET = 3\nuint8 SHUTDOWN = 4\n\nuint8 command\n---\nbool success\n"})}),"\n",(0,s.jsx)(n.h2,{id:"localization",children:(0,s.jsx)(n.strong,{children:"Localization"})}),"\n",(0,s.jsx)(n.p,{children:"Localization is knowing the current position with respect to the environment. This means knowing the position and orientation. This is otherwise known as the pose."}),"\n",(0,s.jsxs)(n.p,{children:["ROS has a very robust algorithm for localization. It uses ",(0,s.jsx)(n.code,{children:"AMCL"})," which is the Adaptive Monte-Carlo Licalization and uses a probabilistic localization system for a robot moving in 2D. It implements the adaptive or KLD sampling Monte Carlo localization approach which uses a particle filter to track a robot's pose against a known map."]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsxs)(n.strong,{children:["A ROS Robot is localized when somebody publishes a transform between the ",(0,s.jsx)(n.code,{children:"/map"})," frame and the ",(0,s.jsx)(n.code,{children:"/odom"})," frame"]})}),"\n",(0,s.jsxs)(n.p,{children:["That means that the ",(0,s.jsx)(n.code,{children:"/odom"})," frame of the robot knows its relative position to the ",(0,s.jsx)(n.code,{children:"/map"})," frame. Therefore, the robot knows its position on the map since ",(0,s.jsx)(n.code,{children:"/base_link"})," frame is directly connected to the ",(0,s.jsx)(n.code,{children:"/odom"})," frame."]}),"\n",(0,s.jsx)(n.p,{children:"When everything is correct, the AMCL publishes that transform."}),"\n",(0,s.jsx)(n.h3,{id:"ros2-localization",children:(0,s.jsx)(n.strong,{children:"ROS2 Localization"})}),"\n",(0,s.jsx)(n.p,{children:"In order to localize, we need three nodes:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"map_server"}),": provides the map to the localization algorithm"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"localization"}),": the algorithm"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"life cycle manager"}),": state manager"]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["Let's create an ",(0,s.jsx)(n.code,{children:"ament_cmake"})," package and the launch file for all three nodes."]}),"\n",(0,s.jsxs)(h.A,{children:[(0,s.jsx)(_.A,{label:"localization.launch.py",value:"localization.launch.py",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-py",children:"from ament_index_python.packages import get_package_share_directory\nfrom launch import LaunchDescription\nfrom launch_ros.actions import Node\nimport os\n\ndef generate_launch_description():\nnav2_yaml = os.path.join(get_package_share_directory('localization'), 'config', 'amcl_config.yaml')\nmap_file = os.path.join(get_package_share_directory('map_server'), 'config', 'turtlebot_area.yaml')\nprint(map_file)\nreturn LaunchDescription([\nNode(\npackage=\"nav2_map_server\",\nexecutable=\"map_server\",\nname=\"map_server\",\noutput=\"screen\",\nparameters=[{'use_sim_time': True}, {'yaml_filename': map_file}] ## This is the saved map we got from our cartography.\n),\nNode(\npackage=\"nav2_amcl\",\nexecutable=\"amcl\",\nname=\"amcl\",\noutput=\"screen\",\nparameters=[nav2_yaml]\n),\nNode(\npackage=\"nav2_lifecycle_manager\",\nLaunch Fil executable=\"lifecycle_manager\",\nname=\"lifecycle_manager\",\noutput=\"screen\",\nparameters=[{'use_sim_time': True},\n{'autostart': True},\n{'node_names': ['map_server', 'amcl']}]\n)\n])\n\n"})})}),(0,s.jsxs)(_.A,{label:"amcl_config.yaml",value:"amcl_config.yaml",children:[(0,s.jsx)(n.p,{children:"The amcl_config specifies the configurations for the localization algorithm. This goes inside of the config directory of your package."}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:'amcl:\n  ros__parameters:\n    use_sim_time: True\n    alpha1: 0.2\n    alpha2: 0.2\n    alpha3: 0.2\n    alpha4: 0.2\n    alpha5: 0.2\n    base_frame_id: "base_footprint"\n    beam_skip_distance: 0.5\n    beam_skip_error_threshold: 0.9\n    beam_skip_threshold: 0.3\n    do_beamskip: false\n    global_frame_id: "map"\n    lambda_short: 0.1\n    laser_likelihood_max_dist: 2.0\n    laser_max_range: 100.0\n    laser_min_range: -1.0\n    laser_model_type: "likelihood_field"\n    max_beams: 60\n    max_particles: 8000\n    min_particles: 200\n    odom_frame_id: "odom"\n    pf_err: 0.05\n    pf_z: 0.99\n    recovery_alpha_fast: 0.0\n    recovery_alpha_slow: 0.0\n    resample_interval: 1\n    robot_model_type: "nav2_amcl::DifferentialMotionModel"\n    save_pose_rate: 0.5\n    sigma_hit: 0.2\n    tf_broadcast: true\n    transform_tolerance: 1.0\n    update_min_a: 0.2\n    update_min_d: 0.25\n    z_hit: 0.5\n    z_max: 0.05\n    z_rand: 0.5\n    z_short: 0.05\n'})})]}),(0,s.jsxs)(_.A,{label:"setup.py/CMakeLists",value:"setup.py/CMakeLists",children:[(0,s.jsx)(n.h4,{id:"for-python",children:(0,s.jsx)(n.strong,{children:"For Python"})}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-py",children:"(os.path.join('share', package_name, 'launch'), glob('launch/*.launch.py')),\n(os.path.join('share', package_name, 'config'), glob('config/*')),\n"})}),(0,s.jsx)(n.h4,{id:"for-c",children:(0,s.jsx)(n.strong,{children:"For C++"})}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-text",children:"install(DIRECTORY\n        launch\n        config\n        DESTINATION $share/{PROJECT_NAME}\n)\n"})})]})]}),"\n",(0,s.jsx)(n.p,{children:"If all is placed correctly, we should be able to receive our old map. From there onwards, you want to configure your RVIZ settings with these below:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"map"}),": Environment"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"TF"}),": Frames of the robot"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"Robot Model"}),": Robot structure (uses URDF model)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"Laser Scan"}),": Estimate of robot position relative to actual map"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"Pose with Covariance"}),": Status of the localization"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"Particle Cloud"}),": See the localization particle distribution"]}),"\n"]}),"\n",(0,s.jsx)(n.admonition,{type:"note",children:(0,s.jsx)(n.p,{children:"Particle cloud uses the reliability policy of best effort and not volatile. If you want to use these configs again, you can save them."})}),"\n",(0,s.jsxs)(n.p,{children:["We can use the ",(0,s.jsx)(n.code,{children:"2D Pose Estimate"})," to tell our ",(0,s.jsx)(n.code,{children:"AMCL"})," system to start localizing the robot. You want to put it at a rough estimate of where the robot is so the algorithm can estimate roughly from the initial state. This'll start publishing the transform between ",(0,s.jsx)(n.code,{children:"map"})," and ",(0,s.jsx)(n.code,{children:"odom"})," topics respectively. When we say transform, it means relationship. The map and odom data are independent from oen another, but there is a mathematical relationship between them using AMCL, and can be used to \"localize\" our robot's position from these data. That's because we have laser scan (environment scanning) and odometry (wheel/position)."]}),"\n",(0,s.jsx)(n.p,{children:"If we start moving our robot, our estimation and localization starts to fit better."}),"\n",(0,s.jsx)("video",{width:"100%",src:d,controls:!0,title:"Localization Video"}),"\n",(0,s.jsx)(n.admonition,{type:"info",children:(0,s.jsxs)(n.p,{children:["For 2D Localization, we only need ",(0,s.jsxs)(n.span,{className:"katex",children:[(0,s.jsx)(n.span,{className:"katex-mathml",children:(0,s.jsx)(n.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,s.jsxs)(n.semantics,{children:[(0,s.jsxs)(n.mrow,{children:[(0,s.jsx)(n.mo,{stretchy:"false",children:"("}),(0,s.jsx)(n.mi,{children:"x"}),(0,s.jsx)(n.mo,{separator:"true",children:","}),(0,s.jsx)(n.mi,{children:"y"}),(0,s.jsx)(n.mo,{separator:"true",children:","}),(0,s.jsx)(n.mi,{children:"\u03b8"}),(0,s.jsx)(n.mo,{stretchy:"false",children:")"})]}),(0,s.jsx)(n.annotation,{encoding:"application/x-tex",children:"(x,y, \\theta)"})]})})}),(0,s.jsx)(n.span,{className:"katex-html","aria-hidden":"true",children:(0,s.jsxs)(n.span,{className:"base",children:[(0,s.jsx)(n.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,s.jsx)(n.span,{className:"mopen",children:"("}),(0,s.jsx)(n.span,{className:"mord mathnormal",children:"x"}),(0,s.jsx)(n.span,{className:"mpunct",children:","}),(0,s.jsx)(n.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,s.jsx)(n.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"y"}),(0,s.jsx)(n.span,{className:"mpunct",children:","}),(0,s.jsx)(n.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,s.jsx)(n.span,{className:"mord mathnormal",style:{marginRight:"0.02778em"},children:"\u03b8"}),(0,s.jsx)(n.span,{className:"mclose",children:")"})]})})]})," and are the variables used for setting the robot in the ",(0,s.jsx)(n.code,{children:"map"})," frame. We can compute ",(0,s.jsxs)(n.span,{className:"katex",children:[(0,s.jsx)(n.span,{className:"katex-mathml",children:(0,s.jsx)(n.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,s.jsxs)(n.semantics,{children:[(0,s.jsxs)(n.mrow,{children:[(0,s.jsx)(n.mo,{stretchy:"false",children:"("}),(0,s.jsx)(n.mi,{children:"x"}),(0,s.jsx)(n.mo,{separator:"true",children:","}),(0,s.jsx)(n.mi,{children:"y"}),(0,s.jsx)(n.mo,{separator:"true",children:","}),(0,s.jsx)(n.mi,{children:"\u03b8"}),(0,s.jsx)(n.mo,{stretchy:"false",children:")"})]}),(0,s.jsx)(n.annotation,{encoding:"application/x-tex",children:"(x,y,\\theta)"})]})})}),(0,s.jsx)(n.span,{className:"katex-html","aria-hidden":"true",children:(0,s.jsxs)(n.span,{className:"base",children:[(0,s.jsx)(n.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,s.jsx)(n.span,{className:"mopen",children:"("}),(0,s.jsx)(n.span,{className:"mord mathnormal",children:"x"}),(0,s.jsx)(n.span,{className:"mpunct",children:","}),(0,s.jsx)(n.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,s.jsx)(n.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"y"}),(0,s.jsx)(n.span,{className:"mpunct",children:","}),(0,s.jsx)(n.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,s.jsx)(n.span,{className:"mord mathnormal",style:{marginRight:"0.02778em"},children:"\u03b8"}),(0,s.jsx)(n.span,{className:"mclose",children:")"})]})})]})," by using the AMCL.\nThe Adaptive Monte Carlo Localization algorithm uses particles to localize the robot. Each particle have their own coordinates, orientation value, and a weight. These weights are the likelihood of the particle being a good estimate of the robot's actual pose based on our sensor data. That means that if our weight is higher for a given particle, that particle is more likely to represent the robot's true pose. These particles are then re-sampled whenever the robot moves and with new sensor data, the higher likelihood particles remain and will converge over many iterations to the robot's true pose."]})}),"\n",(0,s.jsx)(n.p,{children:"To get a good localization of our robot, we need to configure out AMCL node from our amcl_config.yaml. Below are the parameters and their respective categories."}),"\n",(0,s.jsxs)(S,{orientation:"horizontal",children:[(0,s.jsxs)(P,{children:[(0,s.jsx)(L,{children:(0,s.jsxs)(v.XI,{children:[(0,s.jsx)(v.r6,{children:"AMCL Parameters and Descriptions"}),(0,s.jsx)(v.A0,{children:(0,s.jsxs)(v.Hj,{children:[(0,s.jsx)(v.nd,{children:"Parameter"}),(0,s.jsx)(v.nd,{children:"Type"}),(0,s.jsx)(v.nd,{children:"Default"}),(0,s.jsx)(v.nd,{children:"Description"})]})}),(0,s.jsxs)(v.BF,{children:[(0,s.jsxs)(v.Hj,{children:[(0,s.jsx)(v.nA,{children:(0,s.jsx)(n.code,{children:"min_particles"})}),(0,s.jsx)(v.nA,{children:"int"}),(0,s.jsx)(v.nA,{children:"500"}),(0,s.jsx)(v.nA,{children:"Minimum allowed number of particles."})]}),(0,s.jsxs)(v.Hj,{children:[(0,s.jsx)(v.nA,{children:(0,s.jsx)(n.code,{children:"max_particles"})}),(0,s.jsx)(v.nA,{children:"int"}),(0,s.jsx)(v.nA,{children:"2000"}),(0,s.jsx)(v.nA,{children:"Maximum allowed number of particles."})]}),(0,s.jsxs)(v.Hj,{children:[(0,s.jsx)(v.nA,{children:(0,s.jsx)(n.code,{children:"update_min_d"})}),(0,s.jsx)(v.nA,{children:"double"}),(0,s.jsx)(v.nA,{children:"0.25 meters"}),(0,s.jsx)(v.nA,{children:"Translational movement required before performing a filter update."})]}),(0,s.jsxs)(v.Hj,{children:[(0,s.jsx)(v.nA,{children:(0,s.jsx)(n.code,{children:"update_min_a"})}),(0,s.jsx)(v.nA,{children:"double"}),(0,s.jsx)(v.nA,{children:"0.2 radians"}),(0,s.jsx)(v.nA,{children:"Rotational movement required before performing a filter update."})]}),(0,s.jsxs)(v.Hj,{children:[(0,s.jsx)(v.nA,{children:(0,s.jsx)(n.code,{children:"resample_interval"})}),(0,s.jsx)(v.nA,{children:"int"}),(0,s.jsx)(v.nA,{children:"1"}),(0,s.jsx)(v.nA,{children:"Number of filter updates required before re-sampling."})]}),(0,s.jsxs)(v.Hj,{children:[(0,s.jsx)(v.nA,{children:(0,s.jsx)(n.code,{children:"transform_tolerance"})}),(0,s.jsx)(v.nA,{children:"double"}),(0,s.jsx)(v.nA,{children:"1.0 seconds"}),(0,s.jsx)(v.nA,{children:"Time to post-date the published transform, indicating validity into the future."})]}),(0,s.jsxs)(v.Hj,{children:[(0,s.jsx)(v.nA,{children:(0,s.jsx)(n.code,{children:"recovery_alpha_slow"})}),(0,s.jsx)(v.nA,{children:"double"}),(0,s.jsx)(v.nA,{children:"0.0 (disabled)"}),(0,s.jsx)(v.nA,{children:(0,s.jsx)(n.p,{children:"Exponential decay rate for the slow average weight filter; helps decide recovery with random poses. Suggested: 0.001."})})]}),(0,s.jsxs)(v.Hj,{children:[(0,s.jsx)(v.nA,{children:(0,s.jsx)(n.code,{children:"recovery_alpha_fast"})}),(0,s.jsx)(v.nA,{children:"double"}),(0,s.jsx)(v.nA,{children:"0.0 (disabled)"}),(0,s.jsx)(v.nA,{children:(0,s.jsx)(n.p,{children:"Exponential decay rate for the fast average weight filter; helps decide recovery with random poses. Suggested: 0.1."})})]}),(0,s.jsxs)(v.Hj,{children:[(0,s.jsx)(v.nA,{children:(0,s.jsx)(n.code,{children:"set_initial_pose"})}),(0,s.jsx)(v.nA,{children:"bool"}),(0,s.jsx)(v.nA,{children:"false"}),(0,s.jsx)(v.nA,{children:(0,s.jsxs)(n.p,{children:["Causes AMCL to set the initial pose from ",(0,s.jsx)(n.code,{children:"initial_pose*"})," parameters instead of waiting for the ",(0,s.jsx)(n.code,{children:"initial_pose"})," message."]})})]}),(0,s.jsxs)(v.Hj,{children:[(0,s.jsx)(v.nA,{children:(0,s.jsx)(n.code,{children:"initial_pose"})}),(0,s.jsx)(v.nA,{children:"Pose2D"}),(0,s.jsx)(v.nA,{children:0}),(0,s.jsx)(v.nA,{children:"X, Y, Z, and yaw coordinates of the robot base frame's initial pose in the global frame."})]}),(0,s.jsxs)(v.Hj,{children:[(0,s.jsx)(v.nA,{children:(0,s.jsx)(n.code,{children:"always_reset_initial_pose"})}),(0,s.jsx)(v.nA,{children:"bool"}),(0,s.jsx)(v.nA,{children:"false"}),(0,s.jsx)(v.nA,{children:"Requires an initial pose on reset. Uses the last known pose if false."})]}),(0,s.jsxs)(v.Hj,{children:[(0,s.jsx)(v.nA,{children:(0,s.jsx)(n.code,{children:"save_pose_rate"})}),(0,s.jsx)(v.nA,{children:"double"}),(0,s.jsx)(v.nA,{children:"0.5 Hz"}),(0,s.jsx)(v.nA,{children:(0,s.jsx)(n.p,{children:"Maximum rate at which to save the last estimated pose and covariance to the parameter server. Use -1.0 to disable."})})]})]})]})}),(0,s.jsx)(L,{children:(0,s.jsxs)(v.XI,{children:[(0,s.jsx)(v.r6,{children:"Laser Model Parameters"}),(0,s.jsx)(v.A0,{children:(0,s.jsxs)(v.Hj,{children:[(0,s.jsx)(v.nd,{children:"Parameter"}),(0,s.jsx)(v.nd,{children:"Type"}),(0,s.jsx)(v.nd,{children:"Default"}),(0,s.jsx)(v.nd,{children:"Description"})]})}),(0,s.jsxs)(v.BF,{children:[(0,s.jsxs)(v.Hj,{children:[(0,s.jsx)(v.nA,{children:(0,s.jsx)(n.code,{children:"laser_min_range"})}),(0,s.jsx)(v.nA,{children:"double"}),(0,s.jsx)(v.nA,{children:"-1.0"}),(0,s.jsx)(v.nA,{children:"Minimum scan range to be considered. Use laser's minimum range if set to -1.0."})]}),(0,s.jsxs)(v.Hj,{children:[(0,s.jsx)(v.nA,{children:(0,s.jsx)(n.code,{children:"laser_max_range"})}),(0,s.jsx)(v.nA,{children:"double"}),(0,s.jsx)(v.nA,{children:"100"}),(0,s.jsx)(v.nA,{children:"Maximum scan range to be considered. Use laser's maximum range if set to -1.0."})]}),(0,s.jsxs)(v.Hj,{children:[(0,s.jsx)(v.nA,{children:(0,s.jsx)(n.code,{children:"max_beams"})}),(0,s.jsx)(v.nA,{children:"int"}),(0,s.jsx)(v.nA,{children:"60"}),(0,s.jsx)(v.nA,{children:"Number of evenly-spaced beams in each scan used when updating the filter."})]}),(0,s.jsxs)(v.Hj,{children:[(0,s.jsx)(v.nA,{children:(0,s.jsx)(n.code,{children:"z_hit"})}),(0,s.jsx)(v.nA,{children:"double"}),(0,s.jsx)(v.nA,{children:"0.5"}),(0,s.jsxs)(v.nA,{children:["Mixture weight for ",(0,s.jsx)(n.code,{children:"z_hit"})," part of the model."]})]}),(0,s.jsxs)(v.Hj,{children:[(0,s.jsx)(v.nA,{children:(0,s.jsx)(n.code,{children:"z_short"})}),(0,s.jsx)(v.nA,{children:"double"}),(0,s.jsx)(v.nA,{children:"0.05"}),(0,s.jsxs)(v.nA,{children:["Mixture weight for the ",(0,s.jsx)(n.code,{children:"z_short"})," part of the model."]})]}),(0,s.jsxs)(v.Hj,{children:[(0,s.jsx)(v.nA,{children:(0,s.jsx)(n.code,{children:"z_max"})}),(0,s.jsx)(v.nA,{children:"double"}),(0,s.jsx)(v.nA,{children:"0.05"}),(0,s.jsxs)(v.nA,{children:["Mixture weight for the ",(0,s.jsx)(n.code,{children:"z_max"})," part of the model."]})]}),(0,s.jsxs)(v.Hj,{children:[(0,s.jsx)(v.nA,{children:(0,s.jsx)(n.code,{children:"z_rand"})}),(0,s.jsx)(v.nA,{children:"double"}),(0,s.jsx)(v.nA,{children:"0.5"}),(0,s.jsxs)(v.nA,{children:["Mixture weight for the ",(0,s.jsx)(n.code,{children:"z_rand"})," part of the model."]})]}),(0,s.jsxs)(v.Hj,{children:[(0,s.jsx)(v.nA,{children:(0,s.jsx)(n.code,{children:"sigma_hit"})}),(0,s.jsx)(v.nA,{children:"double"}),(0,s.jsx)(v.nA,{children:"0.2 meters"}),(0,s.jsxs)(v.nA,{children:["Standard deviation for Gaussian model used in ",(0,s.jsx)(n.code,{children:"z_hit"})," part."]})]}),(0,s.jsxs)(v.Hj,{children:[(0,s.jsx)(v.nA,{children:(0,s.jsx)(n.code,{children:"lambda_short"})}),(0,s.jsx)(v.nA,{children:"double"}),(0,s.jsx)(v.nA,{children:"0.1"}),(0,s.jsxs)(v.nA,{children:["Exponential decay parameter for the ",(0,s.jsx)(n.code,{children:"z_short"})," part of the model."]})]}),(0,s.jsxs)(v.Hj,{children:[(0,s.jsx)(v.nA,{children:(0,s.jsx)(n.code,{children:"laser_likelihood_max_dist"})}),(0,s.jsx)(v.nA,{children:"double"}),(0,s.jsx)(v.nA,{children:"2.0 meters"}),(0,s.jsx)(v.nA,{children:"Maximum distance for obstacle inflation in the likelihood_field model."})]}),(0,s.jsxs)(v.Hj,{children:[(0,s.jsx)(v.nA,{children:(0,s.jsx)(n.code,{children:"laser_model_type"})}),(0,s.jsx)(v.nA,{children:"string"}),(0,s.jsx)(v.nA,{children:'"likelihood_field"'}),(0,s.jsx)(v.nA,{children:(0,s.jsxs)(n.p,{children:["Model to use: ",(0,s.jsx)(n.code,{children:"beam"}),", ",(0,s.jsx)(n.code,{children:"likelihood_field"}),", or ",(0,s.jsx)(n.code,{children:"likelihood_field_prob"})," (includes beam skipping)."]})})]})]})]})}),(0,s.jsx)(L,{children:(0,s.jsxs)(v.XI,{children:[(0,s.jsx)(v.r6,{children:"Odometry Model Parameters"}),(0,s.jsx)(v.A0,{children:(0,s.jsxs)(v.Hj,{children:[(0,s.jsx)(v.nd,{children:"Parameter"}),(0,s.jsx)(v.nd,{children:"Type"}),(0,s.jsx)(v.nd,{children:"Default"}),(0,s.jsx)(v.nd,{children:"Description"})]})}),(0,s.jsxs)(v.BF,{children:[(0,s.jsxs)(v.Hj,{children:[(0,s.jsx)(v.nA,{children:(0,s.jsx)(n.code,{children:"robot_model_type"})}),(0,s.jsx)(v.nA,{children:"string"}),(0,s.jsx)(v.nA,{children:'"differential"'}),(0,s.jsxs)(v.nA,{children:["Type of motion model: ",(0,s.jsx)(n.code,{children:"differential"})," or ",(0,s.jsx)(n.code,{children:"omnidirectional"}),"."]})]}),(0,s.jsxs)(v.Hj,{children:[(0,s.jsx)(v.nA,{children:(0,s.jsx)(n.code,{children:"alpha1"})}),(0,s.jsx)(v.nA,{children:"double"}),(0,s.jsx)(v.nA,{children:"0.2"}),(0,s.jsx)(v.nA,{children:"Noise in odometry's rotation estimate from rotational motion."})]}),(0,s.jsxs)(v.Hj,{children:[(0,s.jsx)(v.nA,{children:(0,s.jsx)(n.code,{children:"alpha2"})}),(0,s.jsx)(v.nA,{children:"double"}),(0,s.jsx)(v.nA,{children:"0.2"}),(0,s.jsx)(v.nA,{children:"Noise in odometry's rotation estimate from translational motion."})]}),(0,s.jsxs)(v.Hj,{children:[(0,s.jsx)(v.nA,{children:(0,s.jsx)(n.code,{children:"alpha3"})}),(0,s.jsx)(v.nA,{children:"double"}),(0,s.jsx)(v.nA,{children:"0.2"}),(0,s.jsx)(v.nA,{children:"Noise in odometry's translation estimate from translational motion."})]}),(0,s.jsxs)(v.Hj,{children:[(0,s.jsx)(v.nA,{children:(0,s.jsx)(n.code,{children:"alpha4"})}),(0,s.jsx)(v.nA,{children:"double"}),(0,s.jsx)(v.nA,{children:"0.2"}),(0,s.jsx)(v.nA,{children:"Noise in odometry's translation estimate from rotational motion."})]}),(0,s.jsxs)(v.Hj,{children:[(0,s.jsx)(v.nA,{children:(0,s.jsx)(n.code,{children:"alpha5"})}),(0,s.jsx)(v.nA,{children:"double"}),(0,s.jsx)(v.nA,{children:"0.2"}),(0,s.jsxs)(v.nA,{children:["Translation-related noise parameter (only for ",(0,s.jsx)(n.code,{children:"omni"})," model)."]})]}),(0,s.jsxs)(v.Hj,{children:[(0,s.jsx)(v.nA,{children:(0,s.jsx)(n.code,{children:"odom_frame_id"})}),(0,s.jsx)(v.nA,{children:"string"}),(0,s.jsx)(v.nA,{children:'"odom"'}),(0,s.jsx)(v.nA,{children:"Frame to use for odometry."})]}),(0,s.jsxs)(v.Hj,{children:[(0,s.jsx)(v.nA,{children:(0,s.jsx)(n.code,{children:"base_frame_id"})}),(0,s.jsx)(v.nA,{children:"string"}),(0,s.jsx)(v.nA,{children:'"base_footprint"'}),(0,s.jsx)(v.nA,{children:"Frame to use for the robot base."})]}),(0,s.jsxs)(v.Hj,{children:[(0,s.jsx)(v.nA,{children:(0,s.jsx)(n.code,{children:"global_frame_id"})}),(0,s.jsx)(v.nA,{children:"string"}),(0,s.jsx)(v.nA,{children:'"map"'}),(0,s.jsx)(v.nA,{children:"Name of the coordinate frame published by the localization system."})]}),(0,s.jsxs)(v.Hj,{children:[(0,s.jsx)(v.nA,{children:(0,s.jsx)(n.code,{children:"tf_broadcast"})}),(0,s.jsx)(v.nA,{children:"bool"}),(0,s.jsx)(v.nA,{children:"true"}),(0,s.jsx)(v.nA,{children:"Set to false to prevent AMCL from publishing the transform between global and odometry frames."})]})]})]})})]}),(0,s.jsx)(D,{}),(0,s.jsx)(M,{})]}),"\n",(0,s.jsx)(n.h3,{id:"auto-localization",children:(0,s.jsx)(n.strong,{children:"Auto Localization"})}),"\n",(0,s.jsx)(n.h4,{id:"via-yaml",children:(0,s.jsx)(n.strong,{children:"Via YAML"})}),"\n",(0,s.jsxs)(n.p,{children:["If you don't want to localize via GUI ",(0,s.jsx)(n.code,{children:"rviz"}),", you can do so by modifying the configuration settings for ",(0,s.jsx)(n.code,{children:"amcl"}),". When you start your localization server, you're given the initial_pose, to which you can set those within the ",(0,s.jsx)(n.code,{children:"amcl_config"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"set_initial_pose: true\ninitial_pose:\n  x: -4.44264\n  y: 2.32243\n  yaw: 0.328028\n"})}),"\n",(0,s.jsx)(n.p,{children:"Rebuild the package, and you can start the server and not have to localize the robot."}),"\n",(0,s.jsx)(n.h4,{id:"via-cli",children:(0,s.jsx)(n.strong,{children:"Via CLI"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"ros2 topic pub -1 /initialpose geometry_msgs/msg/PoseWithCovarianceStamped \"{header: {stamp: {sec: 0}, frame_id: 'map'}, pose: {pose: {position: {x: 0.2, y: 0.0, z: 0.0}, orientation: {w: 1.0}}}}\"\n"})}),"\n",(0,s.jsx)(n.h3,{id:"global-localization",children:(0,s.jsx)(n.strong,{children:"Global Localization"})}),"\n",(0,s.jsx)(n.p,{children:"Global localization is when neither the person or robot knows where it is on the map. In order to localize itself, it does global localization:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["Distribute all the particles of the filter across the map. (Calls the service ",(0,s.jsx)(n.code,{children:"/reinitialize_global_localization"})]}),"\n",(0,s.jsx)(n.li,{children:"Move the robot around until it detects where the it is located. If the environment is simple, can just rotate itself."}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Modify the amcl_config to increase particles:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"max_particles: 80000\nmin_particles: 2000\n"})}),"\n",(0,s.jsx)(n.p,{children:"Call the service and start moving around to localize."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"ros2 service call /reinitialize_global_localization std_srvs/srv/Empty\n"})}),"\n",(0,s.jsx)(n.h2,{id:"path-planning",children:(0,s.jsx)(n.strong,{children:"Path Planning"})}),"\n",(0,s.jsx)(n.p,{children:"Path planning is planning a route from Point A to Point B, avoiding obstacles along the way."}),"\n",(0,s.jsx)(n.p,{children:"In ROS2, to do path planning, we have to launch several nodes. Before we start any path planning, we need to have two nodes which provides the base map and localization:"}),"\n",(0,s.jsx)(n.h5,{id:"mapping-environment",children:(0,s.jsx)(n.strong,{children:"Mapping Environment"})}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"nav2_map_server"}),": provides the base map as a topic and service"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"nav2_amcl"}),": responsible for localization via Adaptive Monte Carlo Localizer"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"To do path planning, we need these nodes:"}),"\n",(0,s.jsx)(n.h5,{id:"path-planning-1",children:(0,s.jsx)(n.strong,{children:"Path Planning"})}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"planner"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"controller"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"manager_of_recovery_behaviors"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"behavior_tree_navigator"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"nav2_lifecycle_manager"})}),"\n"]}),"\n",(0,s.jsxs)(h.A,{children:[(0,s.jsxs)(_.A,{label:"Planner",value:"Planner",children:[(0,s.jsxs)(n.p,{children:["The planner is responsible for computing a path from Point A to Point B. It can compute a path as soon as the robot receives a ",(0,s.jsx)(n.code,{children:"2D_Goal_Pose"})," and also has access to a global environment representation and sensor data buffered into it ('Global Costmap`)."]}),(0,s.jsxs)(n.p,{children:["Currently on Galactic, there is only one Planenr algorithm available in ROS2, the ",(0,s.jsx)(n.code,{children:"Nav2Fn_Planner"}),"."]}),(0,s.jsx)(n.p,{children:"In order to launch the planner, we need these in the launch file:"}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-py",children:"package='nav2_planner', these in the ```config``` directory.\n<Tabs>\nexecutable='planner_server',\nname='planner_server',\noutput='screen',\nparameters=[nav2_yaml] # contains all of the configuration parameters\n"})}),(0,s.jsx)(n.h5,{id:"nav2_yaml",children:(0,s.jsx)(n.strong,{children:"nav2_yaml"})}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:'planner_server:\n  ros__parameters:\n    expected_planner_frequency: 10.0\n    use_sim_time: True\n    planner_plugins: ["GridBased"]\n    GridBased:\n      plugin: "nav2_navfn_planner/NavfnPlanner"\n      tolerance: 0.5\n      use_astar: false\n      allow_unknown: true\n'})})]}),(0,s.jsxs)(_.A,{label:"Controller",value:"Controller",children:[(0,s.jsx)(n.p,{children:"The controller is responsible for performing reactive path planning from the current position to the maximum range of the sensors. From this data, it builds a trajectory to avoid the obstacles it encounters along the way while trying to follow the path generated by the planner. The controller is the one responsible for generating the wheel's commands."}),(0,s.jsx)(n.p,{children:"There are only two planners available in ROS2:"}),(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"dwb_controller"}),": used with ",(0,s.jsx)(n.code,{children:"differential drive"})," robots"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"TEB controller"}),": used with ",(0,s.jsx)(n.code,{children:"car-like"})," robots (doesn't work properly in Galactic)"]}),"\n"]}),(0,s.jsx)(n.p,{children:"In order to launch the controller, we need these in the launch file:"}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-py",children:"package='nav2_controller',\nexecutable='controller_server',\nname='controller_server',\noutput='screen',\nparameters=[controller_yaml] # contains all of the configuration parameters\n"})}),(0,s.jsx)(n.h5,{id:"controller_yaml",children:(0,s.jsx)(n.strong,{children:"controller_yaml"})}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:'controller_server:\n  ros__parameters:\n    use_sim_time: True\n    controller_frequency: 10.0\n    min_x_velocity_threshold: 0.001\n    min_y_velocity_threshold: 0.5\n    min_theta_velocity_threshold: 0.001\n    failure_tolerance: 0.3\n    progress_checker_plugin: "progress_checker"\n    goal_checker_plugins: ["general_goal_checker"]\n    controller_plugins: ["FollowPath"]\n\n    # Progress checker parameters\n    progress_checker:\n      plugin: "nav2_controller::SimpleProgressChecker"\n      required_movement_radius: 0.5\n      movement_time_allowance: 10.0\n    # Goal checker parameters\n    general_goal_checker:\n      stateful: True\n      plugin: "nav2_controller::SimpleGoalChecker"\n      xy_goal_tolerance: 0.25\n      yaw_goal_tolerance: 0.25\n    # DWB parameters\n    FollowPath:\n      plugin: "dwb_core::DWBLocalPlanner"\n      debug_trajectory_details: True\n      min_vel_x: 0.0\n      min_vel_y: 0.0\n      max_vel_x: 0.26\n      max_vel_y: 0.0\n      max_vel_theta: 1.0\n      min_speed_xy: 0.0\n      max_speed_xy: 0.26\n      min_speed_theta: 0.0\n      acc_lim_x: 2.5\n      acc_lim_y: 0.0\n    - ```dwb_controller```: Used in ```differential drive``` robots   acc_lim_theta: 3.2\n      decel_lim_x: -2.5\n      decel_lim_y: 0.0\n      decel_lim_theta: -3.2\n      vx_samples: 20\n      vy_samples: 5\n      vtheta_samples: 20\n      sim_time: 1.7\n      linear_granularity: 0.05\n      angular_granularity: 0.025\n      transform_tolerance: 0.2\n      xy_goal_tolerance: 0.25\n      trans_stopped_velocity: 0.25\n      short_circuit_trajectory_evaluation: True\n      stateful: True\n      critics: ["RotateToGoal", "Oscillation", "BaseObstacle", "GoalAlign", "PathAlign", "PathDist", "GoalDist"]\n      BaseObstacle.scale: 0.02\n      PathAlign.scale: 32.0\n      PathAlign.forward_point_distance: 0.1\n      GoalAlign.scale: 24.0\n      GoalAlign.forward_point_distance: 0.1\n      PathDist.scale: 32.0\n      GoalDist.scale: 24.0\n      RotateToGoal.scale: 32.0\n      RotateToGoal.slowing_factor: 5.0\n      RotateToGoal.lookahead_time: -1.0\n'})})]}),(0,s.jsxs)(_.A,{label:"Navigation Controller",value:"Navigation Controller",children:[(0,s.jsxs)(n.p,{children:["The navigation controller coordinates between the planner node and the controller node. This node is called the ",(0,s.jsx)(n.code,{children:"bt_navigator"}),". It basically manages these two nodes."]}),(0,s.jsx)(n.p,{children:"Navigation controller launch file:"}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-py",children:"package='nav2_bt_navigator',\nexecutable='bt_navigator',\nname='bt_navigator',\noutput='screen',\nparameters=[bt_navigator_yaml]\n"})}),(0,s.jsx)(n.h5,{id:"bt_navigator_yaml",children:(0,s.jsx)(n.strong,{children:"bt_navigator_yaml"})}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:'bt_navigator:\n  ros__parameters:\n    use_sim_time: True\n    global_frame: map\n    robot_base_frame: base_link\n    odom_topic: /odom\n    bt_loop_duration: 10\n    default_server_timeout: 20\n    default_nav_to_pose_bt_xml: "/home/user/ros2_ws/src/path_planner_server/config/behavior.xml"\n    plugin_lib_names:\n      - nav2_compute_path_to_pose_action_bt_node\n      - nav2_compute_path_through_poses_action_bt_node\n      - nav2_smooth_path_action_bt_node\n      - nav2_follow_path_action_bt_node\n      - nav2_spin_action_bt_node\n      - nav2_wait_action_bt_node\n      - nav2_back_up_action_bt_node\n      - nav2_drive_on_heading_bt_node\n      - nav2_clear_costmap_service_bt_node\n      - nav2_is_stuck_condition_bt_node\n      - nav2_goal_reached_condition_bt_node\n      - nav2_goal_updated_condition_bt_node\n      - nav2_globally_updated_goal_condition_bt_node\n      - nav2_is_path_valid_condition_bt_node\n      - nav2_initial_pose_received_condition_bt_node\n      - nav2_reinitialize_global_localization_service_bt_node\n      - nav2_rate_controller_bt_node\n      - nav2_distance_controller_bt_node\n      - nav2_speed_controller_bt_node\n      - nav2_truncate_path_action_bt_node\n      - nav2_truncate_path_local_action_bt_node\n      - nav2_goal_updater_node_bt_node\n      - nav2_recovery_node_bt_node\n      - nav2_pipeline_sequence_bt_node\n      - nav2_round_robin_node_bt_node\n      - nav2_transform_available_condition_bt_node\n      - nav2_time_expired_condition_bt_node\n      - nav2_path_expiring_timer_condition\n      - nav2_distance_traveled_condition_bt_node\n      - nav2_single_trigger_bt_node\n      - nav2_goal_updated_controller_bt_node\n      - nav2_is_battery_low_condition_bt_node\n      - nav2_navigate_through_poses_action_bt_node\n      - nav2_navigate_to_pose_action_bt_node\n      - nav2_remove_passed_goals_action_bt_node\n      - nav2_planner_selector_bt_node\n      - nav2_controller_selector_bt_node\n      - nav2_goal_checker_selector_bt_node\n      - nav2_controller_cancel_bt_node\n      - nav2_path_longer_on_approach_bt_node\n      - nav2_wait_cancel_bt_node\n      - nav2_spin_cancel_bt_node\n      - nav2_back_up_cancel_bt_node\n      - nav2_drive_on_heading_cancel_bt_node\n'})}),(0,s.jsx)(n.admonition,{type:"info",children:(0,s.jsxs)(n.p,{children:["The behavior of this node is defined by the XML file dubbed ",(0,s.jsx)(n.code,{children:"behavior.xml"})," which contains the behavior tree. This behavior tree includes when to call the path planner, when to call the controller, and when to activate a recovery behavior. More on behavior trees later on in this note."]})}),(0,s.jsx)(n.p,{children:"behavior.xml"}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-xml",children:'\x3c!--\n  This Behavior Tree replans the global path periodically at 1 Hz, and has\n  recovery actions. Obtained from the official Nav2 package\n--\x3e\n<root main_tree_to_execute="MainTree">\n  <BehaviorTree ID="MainTree">\n    <RecoveryNode number_of_retries="6" name="NavigateRecovery">\n      <PipelineSequence name="NavigateWithReplanning">\n        <RateController hz="1.0">\n          <RecoveryNode number_of_retries="1" name="ComputePathToPose">\n            <ComputePathToPose goal="{goal}" path="{path}" planner_id="GridBased"/>\n            <ClearEntireCostmap service_name="global_costmap/clear_entirely_global_costmap"/>\n          </RecoveryNode>\n        </RateController>\n        <RecoveryNode number_of_retries="1" name="FollowPath">\n          <FollowPath path="{path}" controller_id="FollowPath"/>\n          <ClearEntireCostmap service_name="local_costmap/clear_entirely_local_costmap"/>\n        </RecoveryNode>\n      </PipelineSequence>\n      <SequenceStar name="RecoveryActions">\n        <ClearEntireCostmap service_name="local_costmap/clear_entirely_local_costmap"/>\n        <ClearEntireCostmap service_name="global_costmap/clear_entirely_global_costmap"/>\n        <Spin spin_dist="1.57"/>\n        <Wait wait_duration="5"/>\n      </SequenceStar>\n    </RecoveryNode>\n  </BehaviorTree>\n</root>\n'})})]}),(0,s.jsxs)(_.A,{label:"Recoveries Server",value:"Recoveries Server",children:[(0,s.jsxs)(n.p,{children:["When a robot cannot find a valid path to the goal provided or gets stuck in the middle, we use recovery behaviors provided by recovery servers. These are simple predefined movements called via behavior trees. When the robot gets stuck, the ",(0,s.jsx)(n.code,{children:"bt_navigator"})," will call the ",(0,s.jsx)(n.code,{children:"recoverieS_server"}),"."]}),(0,s.jsx)(n.p,{children:"To Launch Recovery Servers:"}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-py",children:"package='nav2_behaviors',\nexecutable='behavior_server', these in the ```config``` directory.\n<Tabs>\nname='behavior_server',\noutput='screen',\nparameters=[recovery_yaml]\n"})}),(0,s.jsx)(n.p,{children:"There are three recovery behaviors available in the Nav2 stack:"}),(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"spin"}),": performs an in-place rotation by a given angle"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"backup"}),": performs a linear translation by a given distance"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"wait"}),": brings the robot to a stationary state"]}),"\n"]}),(0,s.jsxs)(n.p,{children:["We can indicate which one of these behaviors we want to load within the config file ",(0,s.jsx)(n.code,{children:"recovery_yaml"}),"."]}),(0,s.jsx)(n.h5,{id:"recovery_yaml",children:(0,s.jsx)(n.strong,{children:"recovery_yaml"})}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:'behavior_server:\n  ros__parameters:\n    costmap_topic: local_costmap/costmap_raw\n    footprint_topic: local_costmap/published_footprint\n    cycle_frequency: 10.0\n    behavior_plugins: ["spin", "backup", "wait"]\n    spin:\n      plugin: "nav2_behaviors/Spin"\n    backup:\n      plugin: "nav2_behaviors/BackUp"\n    wait:\n      plugin: "nav2_behaviors/Wait"\n    global_frame: odom\n    robot_base_frame: base_link\n    transform_timeout: 0.1\n    use_sim_time: true\n    simulate_ahead_time: 2.0\n    max_rotational_vel: 1.0\n    min_rotational_vel: 0.4\n    rotational_acc_lim: 3.2\n'})})]})]}),"\n",(0,s.jsx)(n.h3,{id:"demo",children:(0,s.jsx)(n.strong,{children:"Demo"})}),"\n",(0,s.jsxs)(n.p,{children:["We'll start by first creating a new package using our favorite CMake build system. We'll then create two directories: ",(0,s.jsx)(n.code,{children:"config"})," and ",(0,s.jsx)(n.code,{children:"launch"}),"."]}),"\n",(0,s.jsx)(n.p,{children:"We then create these and place them in their respective directories."}),"\n",(0,s.jsxs)(h.A,{children:[(0,s.jsx)(_.A,{value:"pathplanner.launch.py",label:"pathplanner.launch.py",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-py",children:"from launch import LaunchDescription\nfrom launch_ros.actions import Node\nfrom ament_index_python.packages import get_package_share_directory\nimport os\n\ndef generate_launch_description():\n\n    planner_yaml = os.path.join(get_package_share_directory('path_planner_server'), 'config', 'planner.yaml')\n    controller_yaml = os.path.join(get_package_share_directory('path_planner_server'), 'config', 'controller.yaml')\n    recovery_yaml = os.path.join(get_package_share_directory('path_planner_server'), 'config', 'recovery.yaml')\n    bt_navigator_yaml = os.path.join(get_package_share_directory('path_planner_server'), 'config', 'bt_navigator.yaml')\n\n    return LaunchDescription([\n        Node(\n            package='nav2_planner',\n            executable='planner_server',\n            name='planner_server',\n            output='screen',\n            parameters=[planner_yaml]\n            ),\n        Node(\n            package='nav2_controller',\n            executable='controller_server',\n            name='controller_server',\n            output='screen', these in the ```config``` directory.\n\n<Tabs>                               these in the ```config``` directory.    \n<Tabs>                                                                                                                                                                \n            parameters=[controller_yaml],\n            ),\n        Node(\n            package='nav2_bt_navigator',\n            executable='bt_navigator',\n            name='bt_navigator',\n            output='screen',\n            parameters=[bt_navigator_yaml],\n            ),\n        Node(\n            package='nav2_behaviors',\n            executable='behavior_server',\n            name='behavior_server',\n            output='screen',\n            parameters=[recovery_yaml],\n            ),\n        Node(\n            package='nav2_lifecycle_manager',\n            executable='lifecycle_manager',\n            name='lifecycle_manager_pathplanner',\n            output='screen',\n            parameters=[{'autostart': True},\n                        {'node_names': ['planner_server', 'controller_server', 'behavior_server', 'bt_navigator']}],\n            )\n        ])\n\n"})})}),(0,s.jsx)(_.A,{value:"planner.yaml",label:"planner.yaml",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:'planner_server:\n  ros__parameters:\n    expected_planner_frequency: 10.0\n    use_sim_time: True\n    planner_plugins: ["GridBased"]\n    GridBased:\n      plugin: "nav2_navfn_planner/NavfnPlanner"\n      tolerance: 0.5\n      use_astar: false\n      allow_unknown: true\n'})})}),(0,s.jsx)(_.A,{value:"controller.yaml",label:"controller.yaml",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:'controller_server:\n  ros__parameters:\n    use_sim_time: True\n    controller_frequency: 10.0\n    min_x_velocity_threshold: 0.001\n    min_y_velocity_threshold: 0.5\n    min_theta_velocity_threshold: 0.001\n    failure_tolerance: 0.3\n    progress_checker_plugin: "progress_checker"\n    goal_checker_plugins: ["general_goal_checker"] \n    controller_plugins: ["FollowPath"]\n\n    progress_checker:\n      plugin: "nav2_controller::SimpleProgressChecker"\n      required_movement_radius: 0.5\n      movement_time_allowance: 10.0\n    general_goal_checker:\n      stateful: True\n      plugin: "nav2_controller::SimpleGoalChecker"\n      xy_goal_tolerance: 0.25\n      yaw_goal_tolerance: 0.25\n    FollowPath:\n      plugin: "dwb_core::DWBLocalPlanner"\n      debug_trajectory_details: True\n      min_vel_x: 0.0\n      min_vel_y: 0.0\n      max_vel_x: 0.26\n      max_vel_y: 0.0\n      max_vel_theta: 1.0\n      min_speed_xy: 0.0\n      max_speed_xy: 0.26\n      min_speed_theta: 0.0\n      acc_lim_x: 2.5\n      acc_lim_y: 0.0\n      acc_lim_theta: 3.2\n      decel_lim_x: -2.5\n      decel_lim_y: 0.0\n      decel_lim_theta: -3.2\n      vx_samples: 20\n      vy_samples: 5\n      vtheta_samples: 20\n      sim_time: 1.7\n      linear_granularity: 0.05\n      angular_granularity: 0.025\n      transform_tolerance: 0.2\n      xy_goal_tolerance: 0.25\n      trans_stopped_velocity: 0.25\n      short_circuit_trajectory_evaluation: True\n      stateful: True\n      critics: ["RotateToGoal", "Oscillation", "BaseObstacle", "GoalAlign", "PathAlign", "PathDist", "GoalDist"]\n      BaseObstacle.scale: 0.02\n      PathAlign.scale: 32.0\n      PathAlign.forward_point_distance: 0.1\n      GoalAlign.scale: 24.0\n      GoalAlign.forward_point_distance: 0.1\n      PathDist.scale: 32.0\n      GoalDist.scale: 24.0\n      RotateToGoal.scale: 32.0\n      RotateToGoal.slowing_factor: 5.0\n      RotateToGoal.lookahead_time: -1.0\n\n'})})}),(0,s.jsx)(_.A,{value:"bt_navigator.yaml",label:"bt_navigator.yaml",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:'bt_navigator:\n  ros__parameters:\n    use_sim_time: True\n    global_frame: map\n    robot_base_frame: base_link\n    odom_topic: /odom\n    bt_loop_duration: 10\n    default_server_timeout: 20\n    default_nav_to_pose_bt_xml: "/home/user/ros2_ws/src/path_planner_server/config/behavior.xml"\n    plugin_lib_names:\n    - nav2_compute_path_to_pose_action_bt_node\n    - nav2_compute_path_through_poses_action_bt_node\n    - nav2_smooth_path_action_bt_node\n    - nav2_follow_path_action_bt_node\n    - nav2_spin_action_bt_node\n    - nav2_wait_action_bt_node\n    - nav2_back_up_action_bt_node\n    - nav2_drive_on_heading_bt_node\n    - nav2_clear_costmap_service_bt_node\n    - nav2_is_stuck_condition_bt_node\n    - nav2_goal_reached_condition_bt_node\n    - nav2_goal_updated_condition_bt_node\n    - nav2_globally_updated_goal_condition_bt_node\n    - nav2_is_path_valid_condition_bt_node\n    - nav2_initial_pose_received_condition_bt_node\n    - nav2_reinitialize_global_localization_service_bt_node\n    - nav2_rate_controller_bt_node\n    - nav2_distance_controller_bt_node\n    - nav2_speed_controller_bt_node\n    - nav2_truncate_path_action_bt_node\n    - nav2_truncate_path_local_action_bt_node\n    - nav2_goal_updater_node_bt_node\n    - nav2_recovery_node_bt_node\n    - nav2_pipeline_sequence_bt_node\n    - nav2_round_robin_node_bt_node\n    - nav2_transform_available_condition_bt_node\n    - nav2_time_expired_condition_bt_node\n    - nav2_path_expiring_timer_condition\n    - nav2_distance_traveled_condition_bt_node\n    - nav2_single_trigger_bt_node\n    - nav2_goal_updated_controller_bt_node\n    - nav2_is_battery_low_condition_bt_node\n    - nav2_navigate_through_poses_action_bt_node\n    - nav2_navigate_to_pose_action_bt_node\n    - nav2_remove_passed_goals_action_bt_node\n    - nav2_planner_selector_bt_node\n    - nav2_controller_selector_bt_node\n    - nav2_goal_checker_selector_bt_node\n    - nav2_controller_cancel_bt_node\n    - nav2_path_longer_on_approach_bt_node\n    - nav2_wait_cancel_bt_node\n    - nav2_spin_cancel_bt_node\n    - nav2_back_up_cancel_bt_node\n    - nav2_drive_on_heading_cancel_bt_node\n'})})}),(0,s.jsx)(_.A,{value:"recovery.yaml",label:"recovery.yaml",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:'behavior_server:\n  ros__parameters:\n    costmap_topic: local_costmap/costmap_raw\n    footprint_topic: local_costmap/published_footprint\n    cycle_frequency: 10.0\n    behavior_plugins: ["spin", "backup", "wait"]\n    spin:\n      plugin: "nav2_behaviors/Spin"\n    backup:\n      plugin: "nav2_behaviors/BackUp"\n    wait:\n      plugin: "nav2_behaviors/Wait"\n    global_frame: odom\n    robot_base_frame: base_link\n    transform_timeout: 0.1\n    use_sim_time: true\n    simulate_ahead_time: 2.0\n    max_rotational_vel: 1.0\n    min_rotational_vel: 0.4\n    rotational_acc_lim: 3.2\n'})})}),(0,s.jsx)(_.A,{value:"behavior.xml",label:"behavior.xml",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-xml",children:'\x3c!--\n  This Behavior Tree replans the global path periodically at 1 Hz, and has\n  recovery actions. Obtained from the official Nav2 package\n--\x3e\n<root main_tree_to_execute="MainTree">\n  <BehaviorTree ID="MainTree">\n    <RecoveryNode number_of_retries="6" name="NavigateRecovery">\n      <PipelineSequence name="NavigateWithReplanning">\n        <RateController hz="1.0">\n          <RecoveryNode number_of_retries="1" name="ComputePathToPose">\n            <ComputePathToPose goal="{goal}" path="{path}" planner_id="GridBased"/>                               \n            <ClearEntireCostmap service_name="global_costmap/clear_entirely_global_costmap"/>\n          </RecoveryNode>\n        </RateController>\n        <RecoveryNode number_of_retries="1" name="FollowPath">\n          <FollowPath path="{path}" controller_id="FollowPath"/>\n          <ClearEntireCostmap service_name="local_costmap/clear_entirely_local_costmap"/>\n        </RecoveryNode>\n      </PipelineSequence>\n      <SequenceStar name="RecoveryActions">\n        <ClearEntireCostmap service_name="local_costmap/clear_entirely_local_costmap"/>\n        <ClearEntireCostmap service_name="global_costmap/clear_entirely_global_costmap"/>\n        <Spin spin_dist="1.57"/>\n        <Wait wait_duration="5"/>\n      </SequenceStar>\n    </RecoveryNode>\n  </BehaviorTree>\n</root>\n'})})})]}),"\n",(0,s.jsx)(n.admonition,{type:"info",children:(0,s.jsx)(n.p,{children:"We have to be running in parallel our localization server, the one responsible for localizing our robot with the map and the one providing the base map environment."})}),"\n",(0,s.jsx)(n.h4,{id:"rviz2-settings",children:(0,s.jsx)(n.strong,{children:"RVIZ2 Settings"})}),"\n",(0,s.jsxs)(n.p,{children:["On top of our settings provided for localization, we add the ",(0,s.jsx)(n.code,{children:"Path"})," display and change LineStyle to ",(0,s.jsx)(n.code,{children:"BillBoards"}),". If everything is set, we can get something cool like below!"]}),"\n",(0,s.jsx)("video",{width:"100%",src:m,controls:!0,title:"Demo Video"}),"\n",(0,s.jsx)(n.h4,{id:"navigation-goal-via-cli",children:(0,s.jsx)(n.strong,{children:"Navigation Goal via CLI"})}),"\n",(0,s.jsxs)(n.p,{children:["We can send a goal via the CLI through the server interface ",(0,s.jsx)(n.code,{children:"/navigate_to_pose"})," or ",(0,s.jsx)(n.code,{children:"goal_pose"}),"."]}),"\n",(0,s.jsxs)(h.A,{children:[(0,s.jsx)(_.A,{label:"Action",value:"Action",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'ros2 action send_goal /navigate_to_pose nav2_msgs/action/NavigateToPose "pose: {header: {frame_id: map}, pose: {position: {x: 1.52, y: 1.92, z: 0.0}, orientation:{x: 0.0, y: 0.0, z: 0, w: 1.0000000}}}"\n'})})}),(0,s.jsx)(_.A,{label:"Topic",value:"Topic",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"ros2 topic pub -1 /goal_pose geometry_msgs/PoseStamped \"{header: {stamp: {sec: 0}, frame_id: 'map'}, pose: {position: {x: 2.2, y: 0.0, z: 0.0}, orientation: {w: 1.0}}}\"\n"})})}),(0,s.jsxs)(_.A,{label:"ROS2 Node",value:"ROS2 Node",children:[(0,s.jsx)(n.p,{children:"Taken directly from The Construct."}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-py",children:"import rclpy\nfrom nav2_msgs.action import NavigateToPose\nfrom rclpy.action import ActionClient\nfrom rclpy.node import Node\nfrom geometry_msgs.msg import PointStamped\n\nclass NavToPoseActionClient(Node):\n\n    def __init__(self):\n        super().__init__('Nav_To_Pose_Action_Client')\n        self._action_client = ActionClient(self, NavigateToPose, '/navigate_to_pose')\n        self.subscriber_ = self.create_subscription(PointStamped, 'clicked_point', self.callback, 1)\n        self.subscriber_  # prevent unused variable warning\n\n    def callback(self, msg):\n        self.get_logger().info('Recieved Data:\\n X : %f \\n Y : %f \\n Z : %f' % (msg.point.x, msg.point.y, msg.point.z))\n        self.send_goal (msg.point.x, msg.point.y, 0.0)\n\n    def send_goal(self, x ,y, theta):\n        self.get_logger().info('sending goal to action server')\n        goal_pose = NavigateToPose.Goal()\n        goal_pose.pose.header.frame_id = 'map'\n        goal_pose.pose.pose.position.x = x\n        goal_pose.pose.pose.position.y = y\n        goal_pose.pose.pose.position.z = theta\n\n        self.get_logger().info('waiting for action server')\n        self._action_client.wait_for_server()\n        self.get_logger().info('action server detected')\n\n        self._send_goal_future = self._action_client.send_goal_async(\n            goal_pose,\n            feedback_callback=self.feedback_callback)\n        self.get_logger().info('goal sent')\n\n        self._send_goal_future.add_done_callback(self.goal_response_callback)\n\n    def goal_response_callback(self, future):\n        goal_handle = future.result()\n        if not goal_handle.accepted:\n            self.get_logger().info('Goal rejected :(')\n            return\n        self.get_logger().info('Goal accepted :)')\n        self._get_result_future = goal_handle.get_result_async()\n\n        self._get_result_future.add_done_callback(self.get_result_callback)\n\n    def get_result_callback(self, future):\n        result = future.result().result\n        self.get_logger().info('Result: {0}' + str(result))\n        rclpy.shutdown()\n\n    def feedback_callback(self, feedback_msg):\n        feedback = feedback_msg.feedback\n        self.get_logger().info('FEEDBACK:' + str(feedback) )\n\ndef main(args=None):\n    rclpy.init(args=args)\n\n    action_client = NavToPoseActionClient()\n\n    rclpy.spin(action_client)\n\n\nif __name__ == '__main__':\n    main()\n"})}),(0,s.jsxs)(n.p,{children:["Used via RVIZ and ",(0,s.jsx)(n.code,{children:"Publish Point"})," feature."]})]})]}),"\n",(0,s.jsx)(n.h2,{id:"obstacle-avoidance",children:(0,s.jsx)(n.strong,{children:"Obstacle Avoidance"})}),"\n",(0,s.jsx)(n.p,{children:"The Nav2 stack avoids dynamic and static obstacles by utilizing what's known as costmaps."}),"\n",(0,s.jsx)(n.h3,{id:"costmaps",children:(0,s.jsx)(n.strong,{children:"Costmaps"})}),"\n",(0,s.jsx)(n.p,{children:"A Costmap is a 2D representation of robot-sensed obstacles on a grid map. Each grid cells contain information about the obstacles detected by the sensors. The cost of the cell can be unknown, free, occupied, or inflated. Different colors indicate how likely it is to colide against an obstacle. Using this information, the Nav2 stack can compute their tasks safely and efficiently."}),"\n",(0,s.jsxs)(n.p,{children:["There are two kinds of costmaps: ",(0,s.jsx)(n.code,{children:"global"})," and ",(0,s.jsx)(n.code,{children:"local"}),"."]}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"global"}),": generated from obstacles on a static map and is used by the ",(0,s.jsx)(n.code,{children:"planner"})," to generate long term path."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"local"}),": created from new obstacles during runtime(sensors) and is used by the ",(0,s.jsx)(n.code,{children:"controller"})," to generate short-term path"]}),"\n"]}),"\n",(0,s.jsx)("img",{src:u().src,width:"100%"}),"\n",(0,s.jsx)(n.h3,{id:"global-costmaps",children:(0,s.jsx)(n.strong,{children:"Global Costmaps"})}),"\n",(0,s.jsxs)(n.p,{children:["To add a ",(0,s.jsx)(n.code,{children:"global costmap"}),", we can add these parameters to the ",(0,s.jsx)(n.code,{children:"planner.yaml"})," file."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:'global_costmap:\n  global_costmap:\n    ros__parameters:\n      update_frequency: 1.0\n      publish_frequency: 1.0\n      global_frame: map\n      robot_base_frame: base_link\n      use_sim_time: True\n      robot_radius: 0.15\n      resolution: 0.05\n      track_unknown_space: true\n      plugins: ["static_layer", "inflation_layer"]\n      static_layer:\n        plugin: "nav2_costmap_2d::StaticLayer"\n        map_subscribe_transient_local: True\n      inflation_layer:\n        plugin: "nav2_costmap_2d::InflationLayer"\n        cost_scaling_factor: 3.0\n        inflation_radius: 0.35\n      always_send_full_costmap: True\n'})}),"\n",(0,s.jsxs)(n.p,{children:["When we run our ",(0,s.jsx)(n.code,{children:"path_planner_server"})," with these new parameters, we see an added map on top of our base map. When we add a new obstacle, the global costmap is not updated. The differences can be seen below. This means that our planner will not take into consideration the new dynamic obstacle that spawned in and will crash."]}),"\n",(0,s.jsx)(n.admonition,{type:"note",children:(0,s.jsx)(n.p,{children:"The different tones of gray are to illustrate the different regions the robot can use. Dark tones of grey means the robot cannot use that area to path plan as it is too close to an obstacle"})}),"\n",(0,s.jsx)(n.h4,{id:"global-costmap-obstacle-layers",children:(0,s.jsx)(n.strong,{children:"Global Costmap Obstacle Layers"})}),"\n",(0,s.jsxs)(n.p,{children:["Global costmaps are generated as the superposition of different obstacle layers. This means that each layer adds a set of obstacles to the ",(0,s.jsx)(n.code,{children:"global costmap"})," based on how the layer computes the obstacles."]}),"\n",(0,s.jsx)(n.p,{children:"Available Costmap layers:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"Static Layer"}),": Adds as obstacles to the ",(0,s.jsx)(n.code,{children:"global costmap"})," any black dot that exists in the static map"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"Inflation Layer"}),": Adds an inflation to any obstacle in the ",(0,s.jsx)(n.code,{children:"global costmap"}),", as a safe distance to maintain"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"Obstacle Layer"}),": Adds to the ",(0,s.jsx)(n.code,{children:"global costmap"})," any object detected by a 2D sensor"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"Voxel Layer"}),": Adds to the ",(0,s.jsx)(n.code,{children:"global costmap"})," 3D obstacles from PointCloud data."]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"We can specify which layers or all in our parameter list via plugins."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:'plugins: ["static_layer", "obstacle_layer", "inflation_layer", "voxel_layer"] # Order matters here, inflation is applied after obstacle, etc.\n'})}),"\n",(0,s.jsx)(n.p,{children:"Adding these layers will allow us to account for dynamic obstacles."}),"\n",(0,s.jsx)(n.h4,{id:"general-parameters",children:(0,s.jsx)(n.strong,{children:"General Parameters"})}),"\n",(0,s.jsxs)(h.A,{children:[(0,s.jsx)(_.A,{value:"global_costmap",label:"global_costmap",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:'global_costmap:\n  global_costmap:\n    ros__parameters:\n      update_frequency: 1.0\n      publish_frequency: 1.0\n      global_frame: map\n      robot_base_frame: base_link\n      use_sim_time: True\n      robot_radius: 0.15\n      resolution: 0.05\n      track_unknown_space: true\n      plugins: ["static_layer", "obstacle_layer", "inflation_layer"]\n'})})}),(0,s.jsx)(_.A,{value:"static_layer",label:"static_layer",children:(0,s.jsxs)(n.p,{children:["Represents a largely unchanging portion of the Costmap, like those generated\nby SLAM. ",(0,s.jsx)(n.code,{children:'yaml static_layer: plugin: "nav2_costmap_2d::StaticLayer"   map_subscribe_transient_local: True '})]})}),(0,s.jsx)(_.A,{value:"inflation_layer",label:"inflation_layer",children:(0,s.jsxs)(n.p,{children:["Adds new values around lethal obstacles to make the Costmap represent robot's\nconfiguration space. ",(0,s.jsx)(n.code,{children:'yaml inflation_layer: plugin:   "nav2_costmap_2d::InflationLayer" cost_scaling_factor: 3.0 inflation_radius:   0.35 '})]})}),(0,s.jsxs)(_.A,{value:"obstacle_layer",label:"obstacle_layer",children:[(0,s.jsx)(n.p,{children:"Tracks obstacles read by sensor data and marks/raytraces obstacles in 2D."}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",metastring:'obstacle_layer: plugin: "nav2_costmap_2d::ObstacleLayer" enabled: True',children:'observation_sources: scan scan: topic: /scan max_obstacle_height: 2.0\nclearing: True marking: True data_type: "LaserScan" raytrace_max_range: 3.0\nraytrace_min_range: 0.0 obstacle_max_range: 2.5 obstacle_min_range: 0.0 ```\n</TabItem>\n\n<TabItem value="voxel_layer" label="voxel_layer">\nResponsible for including 3D detected obstacles in the 2D costmaps.\n```yaml\nvoxel_layer:\nplugin: "nav2_costmap_2d::VoxelLayer"\nenabled: True\nfootprint_clearing_enabled: true\nmax_obstacle_height: 2.0\npublish_voxel_map: True\norigin_z: 0.0\nz_resolution: 0.05\nz_voxels: 16\nmax_obstacle_height: 2.0\nunknown_threshold: 15\nmark_threshold: 0\nobservation_sources: pointcloud\ncombination_method: 1\npointcloud:  # no frame set, uses frame from message\n  topic: /intel_realsense_r200_depth/points\n  max_obstacle_height: 2.0\n  min_obstacle_height: 0.0\n  obstacle_max_range: 2.5\n  obstacle_min_range: 0.0\n  raytrace_max_range: 3.0\n  raytrace_min_range: 0.0\n  clearing: True\n  marking: True\n  data_type: "PointCloud2"\n'})})]})]}),"\n",(0,s.jsx)(n.h3,{id:"local-costmap",children:(0,s.jsx)(n.strong,{children:"Local Costmap"})}),"\n",(0,s.jsxs)(n.p,{children:["Let's figure out how to add a ",(0,s.jsx)(n.code,{children:"local costmap"}),". It's no different than a ",(0,s.jsx)(n.code,{children:"global costmap"})," but goes inside of ",(0,s.jsx)(n.code,{children:"controller.yaml"})," instead of ",(0,s.jsx)(n.code,{children:"planner.yaml"}),". This is because a ",(0,s.jsx)(n.code,{children:"local costmap"})," is a dynamic version of the ",(0,s.jsx)(n.code,{children:"global costmap"})," using sensors."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:'local_costmap:\n  local_costmap:\n    ros__parameters:\n      update_frequency: 5.0\n      publish_frequency: 2.0\n      global_frame: odom\n      robot_base_frame: base_link\n      use_sim_time: True\n      rolling_window: true\n      width: 1\n      height: 1\n      resolution: 0.05\n      robot_radius: 0.15\n      plugins: ["voxel_layer", "inflation_layer"]\n      inflation_layer:\n        plugin: "nav2_costmap_2d::InflationLayer"\n        cost_scaling_factor: 3.0\n        inflation_radius: 0.35\n      voxel_layer:\n        plugin: "nav2_costmap_2d::VoxelLayer"\n        enabled: True\n        publish_voxel_map: True\n        origin_z: 0.0\n        z_resolution: 0.05\n        z_voxels: 16\n        max_obstacle_height: 2.0\n        mark_threshold: 0\n        observation_sources: scan\n        scan:\n          topic: /scan\n          max_obstacle_height: 2.0\n          clearing: True\n          marking: True\n          data_type: "LaserScan"\n          raytrace_max_range: 3.0\n          raytrace_min_range: 0.0\n          obstacle_max_range: 2.5\n          obstacle_min_range: 0.0\n      static_layer:\n        map_subscribe_transient_local: True\n      always_send_full_costmap: True\n'})}),"\n",(0,s.jsxs)(n.admonition,{type:"info",children:[(0,s.jsx)(n.p,{children:"The robot's shape can influence what extent the obstacles in the Costmaps will be inflated to. This is then taken into consideration when computing a path to said point. We can specify our robot's shape within our costmap parameters in both local and global."}),(0,s.jsxs)(n.p,{children:["When we use round robots, we use the parameter ",(0,s.jsx)(n.code,{children:"robot_radius"}),". For more complex robots that aren't round, we have to use ",(0,s.jsx)(n.code,{children:"footprint"})," parameter instead that specifies the coordinates for each point of the robot. The ",(0,s.jsx)(n.code,{children:"footprint"})," parameter is the project of the robot on the ground. For example, if a square robot has 65 cm per side, we would specify:"]}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:'footprint: "[[0.325, 0.325], [0.325, -0.325], [-0.325, -0.325], [-0.325, 0.325]]"\n'})}),(0,s.jsxs)(n.p,{children:["We also have to change the ",(0,s.jsx)(n.code,{children:"controller.yaml"})," configuration:"]}),(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"BaseObstacle"})," if using ",(0,s.jsx)(n.code,{children:"robot_radius"})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"ObstacleFootprint"})," if using ",(0,s.jsx)(n.code,{children:"footprint"})]}),"\n"]}),(0,s.jsxs)(n.p,{children:["Remember that we can only specify one parameter: ",(0,s.jsx)(n.code,{children:"footprint"})," or ",(0,s.jsx)(n.code,{children:"robot_radius"}),"."]})]}),"\n",(0,s.jsx)(n.h3,{id:"demo-1",children:(0,s.jsx)(n.strong,{children:"Demo"})}),"\n",(0,s.jsx)("video",{width:"100%",controls:!0,src:g,title:"Demo Video"}),"\n",(0,s.jsx)(n.h3,{id:"path-planner-package",children:(0,s.jsx)(n.strong,{children:"Path Planner Package"})}),"\n",(0,s.jsxs)(n.p,{children:["Currently, we have two packages: ",(0,s.jsx)(n.code,{children:"localization"})," and ",(0,s.jsx)(n.code,{children:"path_planner"}),". One does the localization and mapping while the other does the path planning. Ideally, for a full navigaiton system, we want a single package with one ",(0,s.jsx)(n.code,{children:"nav2_lifecycle_manager"})," managing all navigation nodes."]}),"\n",(0,s.jsx)(n.p,{children:"How you wanna structure it is up to you, and having separate packages can be good for debugging, but ideally, in real navigation systems for deployment, you want one package for ease of use with one single launch file."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-py",children:"import os\nfrom ament_index_python.packages import get_package_share_directory\nfrom launch import LaunchDescription\nfrom launch_ros.actions import Node\n\ndef generate_launch_description():\n\n    controller_yaml = os.path.join(get_package_share_directory('path_planner_server'), 'config', 'controller.yaml')\n    bt_navigator_yaml = os.path.join(get_package_share_directory('path_planner_server'), 'config', 'bt_navigator.yaml')\n    planner_yaml = os.path.join(get_package_share_directory('path_planner_server'), 'config', 'planner_server.yaml')\n    recovery_yaml = os.path.join(get_package_share_directory('path_planner_server'), 'config', 'recovery.yaml')\n    amcl_yaml = os.path.join(get_package_share_directory('localization_server'), 'config', 'amcl_config.yaml')\n    map_file = os.path.join(get_package_share_directory('map_server'), 'config', 'turtlebot_area.yaml')\n\n    return LaunchDescription([\n        Node(\n            package='nav2_map_server',\n            executable='map_server',\n            name='map_server',\n            output='screen',\n            parameters=[{'use_sim_time': True},\n                        {'yaml_filename':map_file}]\n        ),\n\n        Node(\n            package='nav2_amcl',\n            executable='amcl',\n            name='amcl',\n            output='screen',\n            parameters=[amcl_yaml]\n        ),\n        Node(\n            package='nav2_controller',\n            executable='controller_server',\n            name='controller_server',\n            output='screen',\n            parameters=[controller_yaml]),\n\n        Node(\n            package='nav2_planner',\n            executable='planner_server',\n            name='planner_server',\n            output='screen',\n            parameters=[planner_yaml]),\n\n        Node(\n            package='nav2_behaviors',\n            executable='behavior_server',\n            name='recoveries_server',\n            parameters=[recovery_yaml],\n            output='screen'),\n\n        Node(\n            package='nav2_bt_navigator',\n            executable='bt_navigator',\n            name='bt_navigator',\n            output='screen',\n            parameters=[bt_navigator_yaml]),\n\n        Node(\n            package='nav2_lifecycle_manager',\n            executable='lifecycle_manager',\n            name='lifecycle_manager',\n            output='screen',\n            parameters=[{'autostart': True},\n                        {'node_names': ['map_server',\n                                        'amcl',\n                                        'controller_server',\n                                        'planner_server',\n                                        'recoveries_server',\n                                        'bt_navigator']}])\n    ])\n"})}),"\n",(0,s.jsx)(n.h2,{id:"multi-robot-navigation",children:(0,s.jsx)(n.strong,{children:"Multi-robot Navigation"})}),"\n",(0,s.jsxs)(n.p,{children:["In the scenario you have multiple robots, each robot will have the same ",(0,s.jsx)(n.code,{children:"/cmd_vel"})," topic name, same ",(0,s.jsx)(n.code,{children:"base_footprint"})," frame name and even the same control node name. This is complicated because the navigation stack won't know which robot it's talking to. We can bypass this by using ",(0,s.jsx)(n.code,{children:"namespaces"})," which are labels we assign to each robot. This means that each robot may have the same name but will have a unique ",(0,s.jsx)(n.code,{children:"namespace"})," for it. ",(0,s.jsx)(n.code,{children:"namespaces"})," are configured at:"]}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Simulated Robots"}),": At the URDF description file and the Gazebo plugins"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Real Robots"}),": At the bring-up routine provided by the vendor"]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["If these are not configured properly, the robots will have difficulty booting into ",(0,s.jsx)(n.code,{children:"namespaces"})," mode. For two robots, we could have the following:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-text",children:"/clock\n/parameter_events\n/performance_metrics\n/rosout\n/tb3_0/cmd_vel\n/tb3_0/imu\n/tb3_0/joint_states\n/tb3_0/odom\n/tb3_0/robot_description\n/tb3_0/scan\n/tb3_1/cmd_vel\n/tb3_1/imu\n/tb3_1/joint_states\n/tb3_1/odom\n/tb3_1/robot_description\n/tb3_1/scan\n/tf\n/tf_static\n"})}),"\n",(0,s.jsx)(n.h3,{id:"configuration",children:(0,s.jsx)(n.strong,{children:"Configuration"})}),"\n",(0,s.jsx)(n.p,{children:"To have a multiagent system that uses the same nav stack, we need for each robot:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"localization"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"controller_server"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"planner_server"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"bt_navigator"})}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["The only thing that'll be used by all is the ",(0,s.jsx)(n.code,{children:"map_server"})," as all robots will use the same map."]}),"\n",(0,s.jsx)(n.h3,{id:"mapping",children:(0,s.jsx)(n.strong,{children:"Mapping"})}),"\n",(0,s.jsx)(n.p,{children:"It is possible to have multiple robots collaborate to create a single map between them but that is covered later on. This tutorial goes over:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"One robot from the fleet in charge of making the robot"}),"\n",(0,s.jsxs)(n.li,{children:["A single ",(0,s.jsx)(n.code,{children:"map_server"})," is launched using that map"]}),"\n",(0,s.jsxs)(n.li,{children:["All the navigation systems for each robot will use the same name by asking for the same ",(0,s.jsx)(n.code,{children:"map_server"})]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"multirobot-cartographer",children:(0,s.jsx)(n.strong,{children:"Multirobot cartographer"})}),"\n",(0,s.jsx)(n.p,{children:"There isn't much difference when trying to do multirobot navigation. For mapping, all we do is add and modify a few lines of code. For this, we use our cartographer config files and simply add these few lines of code below."}),"\n",(0,s.jsxs)(h.A,{children:[(0,s.jsx)(_.A,{value:"cartographer_multi.lua",label:"cartographer_multi.lua",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-lua",children:'tracking_frame = "tb3_0/base_footprint",\npublished_frame = "tb3_0/odom",\nodom_frame = "tb3_0/odom"\n'})})}),(0,s.jsx)(_.A,{value:"multi_cartographer.launch.py",label:"multi_cartographer.launch.py",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-py",metastring:"# cartographer_node remappings=[ ('/cmd_vel', '/tb3_0/cmd_vel'),",children:'(\'/odom\', \'/tb3_0/odom\'), (\'/scan\', \'/tb3_0/scan\'), ] ```\n</TabItem>\n\n</Tabs>\n\n:::warn\nWhen localizing with one single robot as above and having the other stand still, the map will think the idle robot is an obstacle.\n:::\n\n### **Localization**\n\nWe can launch a localization system for each robot. This means launching two `amcl` nodes each configured for their respective robot.\n\n<Tabs>\n<TabItem value="Step 1" label="Step 1">\n- Add a ```namespace``` variable to the launches of ```amcl``` nodes.\n- Create a new launch file named ```multi_localization.launch.py``` to include two ```amcl``` nodes, each with a different namespace, according to the robot it will localize. Note that each node\'s parameters argument must point to **two** config files.\n- Try to use the cleaned map that doesn\'t include the idle robot as an obstacle. You can edit the ```.pgm``` file using ```GIMP```.\n\n```py\nNode(\n    namespace="tb3_0",\n    package="nav2_amcl",\n    executable="amcl",\n    name="amcl",\n    output="screen",\n    parameters=[tb3_0_config],\n    ),\nNode(\n    namespace="tb3_1",\n    package="nav2_amcl",\n    executable="amcl",\n    name+"amcl",\n    output="screen",\n    parameters=[tb3_1_config],\n    ),\n'})})}),(0,s.jsxs)(_.A,{label:"Step 2",value:"Step 2",children:[(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Create two copies of the ",(0,s.jsx)(n.code,{children:"amcl_config.yaml"})," file, with each one of the names referencing the robot it controls. Example: ",(0,s.jsx)(n.code,{children:"tb3_0_amcl_config.yaml"})]}),"\n",(0,s.jsxs)(n.li,{children:["Modify the ",(0,s.jsx)(n.code,{children:"amcl_config.yaml"})," files to make sure it fits the robot needs."]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Modifying the first line to contain the ",(0,s.jsx)(n.strong,{children:"full new name"})," of the node."]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["All frames must be modified to include the ",(0,s.jsx)(n.code,{children:"namespace"}),". The only frame that doesn't have to be changed is the ",(0,s.jsx)(n.code,{children:"global_frame_id"})," sincei t's a global single frame for all the robots."]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Topics don't need to be modified because the ",(0,s.jsx)(n.code,{children:"namespace"})," arguments of the launch file automatically modifies them. This doesn't apply to frames."]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["The ",(0,s.jsx)(n.code,{children:"map_topic"})," parameters must be forced to ",(0,s.jsx)(n.code,{children:"/map"}),". If we don't do this with ",(0,s.jsx)(n.code,{children:"/"}),", then it automatically uses ",(0,s.jsx)(n.code,{children:"tb3_0/map"})," as the topic which isn't the topic the map server publishes."]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["Import the two config files into the ",(0,s.jsx)(n.code,{children:"multi_localization.launch.py"})]}),"\n",(0,s.jsx)(n.li,{children:"Assign it to their respective nodes."}),"\n"]}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:'# tb3_0_amcl_config.yaml\ntb3_0/amcl:\n  ros__parameters:\n    use_sim_time: True\n    alpha1: 0.2\n    alpha2: 0.2\n    alpha3: 0.2\n    alpha4: 0.2\n    alpha5: 0.2\n    base_frame_id: "tb3_0/base_footprint"\n    beam_skip_distance: 0.5\n    beam_skip_error_threshold: 0.9\n    beam_skip_threshold: 0.3\n    do_beamskip: false\n    global_frame_id: "map"\n    lambda_short: 0.1\n    laser_likelihood_max_dist: 2.0\n    laser_max_range: 100.0\n    laser_min_range: -1.0\n    laser_model_type: "likelihood_field"\n    max_beams: 60\n    max_particles: 8000\n    min_particles: 200\n    odom_frame_id: "tb3_0/odom"\n    pf_err: 0.05\n    pf_z: 0.99\n    recovery_alpha_fast: 0.0\n    recovery_alpha_slow: 0.0\n    resample_interval: 1\n    robot_model_type: "nav2_amcl::DifferentialMotionModel"\n    save_pose_rate: 0.5\n    sigma_hit: 0.2\n    tf_broadcast: true\n    transform_tolerance: 1.0\n    update_min_a: 0.2\n    update_min_d: 0.25\n    z_hit: 0.5\n    z_max: 0.05\n    z_rand: 0.5\n    z_short: 0.05\n    scan_topic: "/tb3_0/scan"\n    map_topic: "/map"\n    set_initial_pose: true\n    initial_pose:\n      x: 0.0\n      y: 0.0\n      yaw: 0.0\n'})})]}),(0,s.jsxs)(_.A,{label:"Step 3",value:"Step 3",children:[(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Add the full node names to the lifecycle manager with their ",(0,s.jsx)(n.code,{children:"namespaces"})]}),"\n"]}),(0,s.jsx)(n.admonition,{type:"info",children:(0,s.jsxs)(n.p,{children:["We have to add a new parameter ",(0,s.jsx)(n.code,{children:"{'bond_timeout': 0.0}"})," to prevent launching errors"]})}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-py",children:"Node(\n    package='nav2_lifecycle_manager',\n    executable='lifecycle_manager',\n    name='lifecycle_manager_localization',\n    output='screen',\n    parameters=[{'use_sim_time': True},\n                {'autostart': True},\n                {'bond_timeout':0.0},\n                {'node_names': ['map_server', 'tb3_0/amcl', 'tb3_1/amcl']}]\n)\n"})})]}),(0,s.jsxs)(_.A,{label:"Step 4",value:"Step 4",children:[(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Modify the ",(0,s.jsx)(n.code,{children:"map_server"})," launch file."]}),"\n",(0,s.jsxs)(n.li,{children:["Specify the ",(0,s.jsx)(n.code,{children:"topic_name"})," and ",(0,s.jsx)(n.code,{children:"frame_id"})," of the ",(0,s.jsx)(n.code,{children:"map_server"}),". These parameters aren't configured when we do a single robot ",(0,s.jsx)(n.code,{children:"map_server"}),"."]}),"\n"]}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-py",children:"Node(\n    package='nav2_map_server',\n    executable='map_server',\n    name='map_server',\n    output='screen',\n    parameters=[{'use_sim_time': True}, \n                {'topic_name':\"map\"},\n                {'frame_id':\"map\"},\n                {'yaml_filename':map_file}]\n),\n"})}),(0,s.jsx)(n.p,{children:"The final launch file should be:"}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-py",children:"import os\n\nfrom ament_index_python.packages import get_package_share_directory\nfrom launch import LaunchDescription\nfrom launch_ros.actions import Node\n\ndef generate_launch_description():\n\n    tb3_0_nav2_yaml = os.path.join(get_package_share_directory('localization_server'), 'config', 'tb3_0_amcl_config.yaml')\n    tb3_1_nav2_yaml = os.path.join(get_package_share_directory('localization_server'), 'config', 'tb3_1_amcl_config.yaml')\n    map_file = os.path.join(get_package_share_directory('map_server'), 'config', 'turtlebot_area_two_robots_clean.yaml')\n\n    return LaunchDescription([\n        Node(\n            package='nav2_map_server',\n            executable='map_server',\n            name='map_server',\n            output='screen',\n            parameters=[{'use_sim_time': True},\n                        {'topic_name':\"map\"},\n                        {'frame_id':\"map\"},\n                        {'yaml_filename':map_file}]\n        ),\n\n        Node(\n            namespace='tb3_0',\n            package='nav2_amcl',\n            executable='amcl',\n            name='amcl',\n            output='screen',\n            parameters=[tb3_0_nav2_yaml]\n        ),\n        Node(\n            namespace='tb3_1',\n            package='nav2_amcl',\n            executable='amcl',\n            name='amcl',\n            output='screen',\n            parameters=[tb3_1_nav2_yaml]\n        ),\n\n\n        Node(\n            package='nav2_lifecycle_manager',\n            executable='lifecycle_manager',\n            name='lifecycle_manager_localization',\n            output='screen',\n            parameters=[{'use_sim_time': True},\n                        {'autostart': True},\n                        {'bond_timeout':0.0},\n                        {'node_names': ['map_server', 'tb3_0/amcl', 'tb3_1/amcl']}]\n        )\n    ])\n"})})]})]}),"\n",(0,s.jsx)(n.h4,{id:"configuring-rviz2",children:(0,s.jsx)(n.strong,{children:"Configuring RVIZ2"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Load the RVIZ configuration of the localization unit: ",(0,s.jsx)(n.code,{children:".rviz"})]}),"\n",(0,s.jsxs)(n.li,{children:["Modify the topic of the ",(0,s.jsx)(n.code,{children:"LaserScan"})," to point to the ",(0,s.jsx)(n.code,{children:"tb3_0/scan"})," and indicate the ",(0,s.jsx)(n.code,{children:"Color Transformer"})," as ",(0,s.jsx)(n.code,{children:"FlatColor"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["Add another ",(0,s.jsx)(n.code,{children:"LaserScan"})," and make it ",(0,s.jsx)(n.code,{children:"tb3_1/scan"})," with ",(0,s.jsx)(n.code,{children:"Color Transformer"})," as the same as previous but different color."]}),"\n",(0,s.jsxs)(n.li,{children:["Modify the ",(0,s.jsx)(n.code,{children:"RobotModel"})," display as below:"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["In the ",(0,s.jsx)(n.code,{children:"Description Source"}),", select ",(0,s.jsx)(n.code,{children:"Topic"})," and indicate ",(0,s.jsx)(n.code,{children:"/tb3_0/robot_description"}),"."]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["In the ",(0,s.jsx)(n.code,{children:"TF prefix"}),", indicate the namespace of the robot, which for tb3_0 is ",(0,s.jsx)(n.code,{children:"tb3_0"}),"."]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["Do the same for ",(0,s.jsx)(n.code,{children:"tb3_1"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["Add the ",(0,s.jsx)(n.code,{children:"Panel"})," of ",(0,s.jsx)(n.code,{children:"Tool Properties"})," and modify it such that the topics for ",(0,s.jsx)(n.code,{children:"2D Pose Estimate"}),". (You do this to localize each robot individually)"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Should always be ",(0,s.jsx)(n.code,{children:"/namespace/topic_name"}),"."]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["You should relaunch the simulation because the robots will ",(0,s.jsx)(n.strong,{children:"drift"})," if given a long time of idling in the simulation. Then localize by doing the ",(0,s.jsx)(n.code,{children:"2D Pose Estimate"}),"."]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"After, we should get something like this:"}),"\n",(0,s.jsx)("img",{src:j().src,width:"100%"}),"\n",(0,s.jsx)("img",{src:"https://s3.eu-west-1.amazonaws.com/notebooks.ws/ros2-navigation-humble-148/images/global_tf_localized.png"}),"\n",(0,s.jsx)(n.h3,{id:"path-planning-2",children:(0,s.jsx)(n.strong,{children:"Path Planning"})}),"\n",(0,s.jsx)(n.p,{children:"To path plan for multiple robots, we need n path planning node systems. This means for our two robot, we need:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["two ",(0,s.jsx)(n.code,{children:"controller_server"})," nodes"]}),"\n",(0,s.jsxs)(n.li,{children:["two ",(0,s.jsx)(n.code,{children:"planner_server"})," nodes"]}),"\n",(0,s.jsxs)(n.li,{children:["two ",(0,s.jsx)(n.code,{children:"recoveries_server"})," nodes"]}),"\n",(0,s.jsxs)(n.li,{children:["two ",(0,s.jsx)(n.code,{children:"bt_navigator"})," nodes"]}),"\n"]}),"\n",(0,s.jsxs)(h.A,{children:[(0,s.jsxs)(_.A,{label:"Step 1",value:"Step 1",children:[(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Add a ",(0,s.jsx)(n.code,{children:"namespace"})," to the launches of the nodes."]}),"\n"]}),(0,s.jsxs)(n.p,{children:["Example below for one single node, the ",(0,s.jsx)(n.code,{children:"planner_server"}),". We need to do this for the 4 nodes, for each robot, meaning we should have 8 nodes in total for the path planning system."]}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-py",children:"Node(\n    namespace='tb3_0',\n    package='nav2_planner',\n    executable='planner_server',\n    name='planner_server',\n    output='screen',\n    parameters=[planner_yaml_tb1_0]\n),\n"})})]}),(0,s.jsxs)(_.A,{label:"Step 2",value:"Step 2",children:[(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Create respective config files for each robot."}),"\n",(0,s.jsxs)(n.li,{children:["This means two of each yamls for ",(0,s.jsx)(n.code,{children:"planner_server"}),", ",(0,s.jsx)(n.code,{children:"controller"}),", ",(0,s.jsx)(n.code,{children:"bt_navigator"}),", ",(0,s.jsx)(n.code,{children:"recovery"})," files."]}),"\n",(0,s.jsxs)(n.li,{children:["Modify the content of each file and name it with good convention such as ",(0,s.jsx)(n.code,{children:"tb3_0_planner_server.yaml"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["First line must contain the full new name of the node: ",(0,s.jsx)(n.code,{children:"tb3_0/planner_server"})]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["All frames of the config must be modified to include the ",(0,s.jsx)(n.code,{children:"namespace"}),". The ",(0,s.jsx)(n.code,{children:"global_frame_id"})," doesn't need to since it's a single global frame."]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Topics don't need to be modified since they're done via launch file with the argument ",(0,s.jsx)(n.code,{children:"namespace"}),"."]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["The ",(0,s.jsx)(n.code,{children:"map_topic"})," must be forced to ",(0,s.jsx)(n.code,{children:"/map"})," or else the map server will be publishing to ",(0,s.jsx)(n.code,{children:"tb3_0/map"}),"."]}),"\n"]}),"\n"]}),"\n"]}),(0,s.jsxs)(h.A,{children:[(0,s.jsxs)(_.A,{label:"planner_server",value:"planner_server",children:[(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Change ",(0,s.jsx)(n.code,{children:"global_costmap"})," to include the namespace: ",(0,s.jsx)(n.code,{children:"tb3_0/global_costmap"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["Do the same for ",(0,s.jsx)(n.code,{children:"robot_base_frame"}),": ",(0,s.jsx)(n.code,{children:"robot_base_frame: tb3_0/base_link"}),"."]}),"\n"]}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:'tb3_0/planner_server:\n  ros__parameters:\n    expected_planner_frequency: 10.0\n    use_sim_time: True\n    planner_plugins: ["GridBased"]\n    GridBased:\n      plugin: "nav2_navfn_planner/NavfnPlanner"\n      tolerance: 0.5\n      use_astar: false\n      allow_unknown: true\n\ntb3_0/global_costmap:\n  global_costmap:\n    ros__parameters:\n      update_frequency: 1.0\n      publish_frequency: 1.0\n      global_frame: map\n      # This has to be set\n      map_topic: /map\n      robot_base_frame: tb3_0/base_link\n      use_sim_time: True\n      robot_radius: 0.15\n      resolution: 0.05\n      track_unknown_space: true\n      plugins: ["static_layer", "obstacle_layer", "inflation_layer"]\n      static_layer:\n        plugin: "nav2_costmap_2d::StaticLayer"\n        map_subscribe_transient_local: True\n      inflation_layer:\n        plugin: "nav2_costmap_2d::InflationLayer"\n        cost_scaling_factor: 3.0\n        inflation_radius: 0.35\n      always_send_full_costmap: True\n      obstacle_layer:\n        plugin: "nav2_costmap_2d::ObstacleLayer"\n        enabled: True\n        observation_sources: scan\n        scan:\n          # The scan is let as is because with namespace on topc it remaps properly , NO f.slash\n          topic: /tb3_0/scan\n          max_obstacle_height: 2.0\n          clearing: True\n          marking: True\n          data_type: "LaserScan"\n          raytrace_max_range: 3.0\n          raytrace_min_range: 0.0\n          obstacle_max_range: 2.5\n          obstacle_min_range: 0.0\n'})})]}),(0,s.jsxs)(_.A,{label:"controller.yaml",value:"controller.yaml",children:[(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Same as planner_server"}),"\n"]}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:'tb3_0/controller_server:\n  ros__parameters:\n    use_sim_time: True\n    controller_frequency: 10.0\n    min_x_velocity_threshold: 0.001\n    min_y_velocity_threshold: 0.5\n    min_theta_velocity_threshold: 0.001\n    failure_tolerance: 0.3\n    progress_checker_plugin: "progress_checker"\n    goal_checker_plugins: ["general_goal_checker"] \n    controller_plugins: ["FollowPath"]\n\n    # Progress checker parameters\n    progress_checker:\n      plugin: "nav2_controller::SimpleProgressChecker"\n      required_movement_radius: 0.5\n      movement_time_allowance: 10.0\n    # Goal checker parameters\n    general_goal_checker:\n      stateful: True\n      plugin: "nav2_controller::SimpleGoalChecker"\n      xy_goal_tolerance: 0.25\n      yaw_goal_tolerance: 0.25\n    # DWB parameters\n    FollowPath:\n      plugin: "dwb_core::DWBLocalPlanner"\n      debug_trajectory_details: True\n      min_vel_x: 0.0\n      min_vel_y: 0.0\n      max_vel_x: 0.26\n      max_vel_y: 0.0\n      max_vel_theta: 1.0\n      min_speed_xy: 0.0\n      max_speed_xy: 0.26\n      min_speed_theta: 0.0\n      acc_lim_x: 2.5\n      acc_lim_y: 0.0\n      acc_lim_theta: 3.2\n      decel_lim_x: -2.5\n      decel_lim_y: 0.0\n      decel_lim_theta: -3.2\n      vx_samples: 20\n      vy_samples: 5\n      vtheta_samples: 20\n      sim_time: 1.7\n      linear_granularity: 0.05\n      angular_granularity: 0.025\n      transform_tolerance: 0.2\n      xy_goal_tolerance: 0.25\n      trans_stopped_velocity: 0.25\n      short_circuit_trajectory_evaluation: True\n      stateful: True\n      critics: ["RotateToGoal", "Oscillation", "BaseObstacle", "GoalAlign", "PathAlign", "PathDist", "GoalDist"]\n      BaseObstacle.scale: 0.02\n      PathAlign.scale: 32.0\n      PathAlign.forward_point_distance: 0.1\n      GoalAlign.scale: 24.0\n      GoalAlign.forward_point_distance: 0.1\n      PathDist.scale: 32.0\n      GoalDist.scale: 24.0\n      RotateToGoal.scale: 32.0\n      RotateToGoal.slowing_factor: 5.0\n      RotateToGoal.lookahead_time: -1.0\n\ntb3_0/local_costmap:\nlocal_costmap:\nros\\_\\_parameters:\nupdate_frequency: 5.0\npublish_frequency: 2.0\nglobal_frame: tb3_0/odom\nrobot_base_frame: tb3_0/base_link\nuse_sim_time: True\nrolling_window: true\nwidth: 1\nheight: 1\nresolution: 0.05\nrobot_radius: 0.15\nplugins: ["voxel_layer", "inflation_layer"]\ninflation_layer:\nplugin: "nav2_costmap_2d::InflationLayer"\ncost_scaling_factor: 3.0\ninflation_radius: 0.35\nvoxel_layer:\nplugin: "nav2_costmap_2d::VoxelLayer"\nenabled: True\npublish_voxel_map: True\norigin_z: 0.0\nz_resolution: 0.05\nz_voxels: 16\nmax_obstacle_height: 2.0\nmark_threshold: 0\nobservation_sources: scan\nscan:\ntopic: /tb3_0/scan\nmax_obstacle_height: 2.0\nclearing: True\nmarking: True\ndata_type: "LaserScan"\nraytrace_max_range: 3.0\nraytrace_min_range: 0.0\nobstacle_max_range: 2.5\nobstacle_min_range: 0.0\nstatic_layer:\nmap_subscribe_transient_local: True\nalways_send_full_costmap: True\n\n'})})]}),(0,s.jsxs)(_.A,{label:"bt_navigator.yaml",value:"bt_navigator.yaml",children:[(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Set the ",(0,s.jsx)(n.code,{children:"base_frame"})," to include ",(0,s.jsx)(n.code,{children:"namespace"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["Set the ",(0,s.jsx)(n.code,{children:"default_nav_to_pose_bt_xml"})," via absolute path. If you wanna do relative, you can. ",(0,s.jsx)(n.code,{children:'default_nav_to_pose_bt_xml: "/home/user/ros2_ws/src/path_planner_server/config/behavior.xml"'})]}),"\n",(0,s.jsxs)(n.li,{children:["Also remove the publication of behavior status of Groot or else the Groot introspection port for one ",(0,s.jsx)(n.code,{children:"bt-navigator"})," will collide with the port of the other. ",(0,s.jsx)(n.a,{href:"https://github.com/ros-navigation/navigation2/issues/2386",children:"Reference"})]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["To disconnect, add to eahc of the ",(0,s.jsx)(n.code,{children:"bt-navigator"}),": ",(0,s.jsx)(n.code,{children:"enable_groot_monitoring: false"})]}),"\n"]}),"\n"]}),"\n"]}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:'tb3_0/bt_navigator:\n  ros__parameters:\n    use_sim_time: True\n    global_frame: map\n    robot_base_frame: tb3_0/base_link\n    odom_topic: tb3_0/odom\n    bt_loop_duration: 10\n    default_server_timeout: 20\n    default_nav_to_pose_bt_xml: "/home/user/ros2_ws/src/path_planner_server/config/behavior.xml"\n    enable_groot_monitoring: false\n    plugin_lib_names:\n    - nav2_compute_path_to_pose_action_bt_node\n    - nav2_compute_path_through_poses_action_bt_node\n    - nav2_smooth_path_action_bt_node\n    - nav2_follow_path_action_bt_node\n    - nav2_spin_action_bt_node\n    - nav2_wait_action_bt_node\n    - nav2_back_up_action_bt_node\n    - nav2_drive_on_heading_bt_node\n    - nav2_clear_costmap_service_bt_node\n    - nav2_is_stuck_condition_bt_node\n    - nav2_goal_reached_condition_bt_node\n    - nav2_goal_updated_condition_bt_node\n    - nav2_globally_updated_goal_condition_bt_node\n    - nav2_is_path_valid_condition_bt_node\n    - nav2_initial_pose_received_condition_bt_node\n    - nav2_reinitialize_global_localization_service_bt_node\n    - nav2_rate_controller_bt_node\n    - nav2_distance_controller_bt_node\n    - nav2_speed_controller_bt_node\n    - nav2_truncate_path_action_bt_node\n    - nav2_truncate_path_local_action_bt_node\n    - nav2_goal_updater_node_bt_node\n    - nav2_recovery_node_bt_node\n    - nav2_pipeline_sequence_bt_node\n    - nav2_round_robin_node_bt_node\n    - nav2_transform_available_condition_bt_node\n    - nav2_time_expired_condition_bt_node\n    - nav2_path_expiring_timer_condition\n    - nav2_distance_traveled_condition_bt_node\n    - nav2_single_trigger_bt_node\n    - nav2_goal_updated_controller_bt_node\n    - nav2_is_battery_low_condition_bt_node\n    - nav2_navigate_through_poses_action_bt_node\n    - nav2_navigate_to_pose_action_bt_node\n    - nav2_remove_passed_goals_action_bt_node\n    - nav2_planner_selector_bt_node\n    - nav2_controller_selector_bt_node\n    - nav2_goal_checker_selector_bt_node\n    - nav2_controller_cancel_bt_node\n    - nav2_path_longer_on_approach_bt_node\n    - nav2_wait_cancel_bt_node\n    - nav2_spin_cancel_bt_node\n    - nav2_back_up_cancel_bt_node\n    - nav2_drive_on_heading_cancel_bt_node\n'})}),(0,s.jsx)(n.admonition,{type:"info",children:(0,s.jsxs)(n.p,{children:["We use the same ",(0,s.jsx)(n.code,{children:"behavior.xml"})," for both robots."]})})]}),(0,s.jsxs)(_.A,{label:"recovery.yaml",value:"recovery.yaml",children:[(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Same steps as first two."}),"\n"]}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:'tb3_0/behavior_server:\n  ros__parameters:\n    costmap_topic: local_costmap/costmap_raw\n    footprint_topic: local_costmap/published_footprint\n    cycle_frequency: 10.0\n    behavior_plugins: ["spin", "backup", "wait"]\n    spin:\n      plugin: "nav2_behaviors/Spin"\n    backup:\n      plugin: "nav2_behaviors/BackUp"\n    wait:\n      plugin: "nav2_behaviors/Wait"\n    global_frame: tb3_0/odom\n    robot_base_frame: tb3_0/base_link\n    transform_timeout: 0.1\n    use_sim_time: true\n    simulate_ahead_time: 2.0\n    max_rotational_vel: 1.0\n    min_rotational_vel: 0.4\n    rotational_acc_lim: 3.2\n'})})]})]})]}),(0,s.jsxs)(_.A,{label:"Step 3",value:"Step 3",children:[(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Add the nodes to the lifecycle manager"}),"\n"]}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-py",children:"Node(\n    package='nav2_lifecycle_manager',\n    executable='lifecycle_manager',\n    name='lifecycle_manager_pathplanner',\n    output='screen',\n    parameters=[{'autostart': True},\n                {'bond_timeout':0.0},\n                {'node_names': [\n                                'tb3_0/planner_server',\n                                'tb3_0/controller_server',\n                                'tb3_0/recoveries_server',\n                                'tb3_0/bt_navigator',\n                                'tb3_1/planner_server',\n                                'tb3_1/controller_server',\n                                'tb3_1/recoveries_server',\n                                'tb3_1/bt_navigator'\n                                ]}])\n"})}),(0,s.jsx)(n.p,{children:"The final launch file should look like this."}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-py",children:"import os\nfrom ament_index_python.packages import get_package_share_directory\nfrom launch import LaunchDescription\nfrom launch_ros.actions import Node\n\ndef generate_launch_description():\n\n    controller_yaml_tb3_0 = os.path.join(get_package_share_directory('path_planner_server'), 'config', 'tb3_0_controller.yaml')\n    planner_yaml_tb3_0 = os.path.join(get_package_share_directory('path_planner_server'), 'config', 'tb3_0_planner_server.yaml')\n    recovery_yaml_tb3_0 = os.path.join(get_package_share_directory('path_planner_server'), 'config', 'tb3_0_recovery.yaml')\n    bt_navigator_yaml_tb3_0 = os.path.join(get_package_share_directory('path_planner_server'), 'config', 'tb3_0_bt_navigator.yaml')\n\n    controller_yaml_tb3_1 = os.path.join(get_package_share_directory('path_planner_server'), 'config', 'tb3_1_controller.yaml')\n    planner_yaml_tb3_1 = os.path.join(get_package_share_directory('path_planner_server'), 'config', 'tb3_1_planner_server.yaml')\n    recovery_yaml_tb3_1 = os.path.join(get_package_share_directory('path_planner_server'), 'config', 'tb3_1_recovery.yaml')\n    bt_navigator_yaml_tb3_1 = os.path.join(get_package_share_directory('path_planner_server'), 'config', 'tb3_1_bt_navigator.yaml')\n\n\n    return LaunchDescription([\n\n        ## TB3_0\n        Node(\n            namespace='tb3_0',\n            package='nav2_controller',\n            executable='controller_server',\n            name='controller_server',\n            output='screen',\n            parameters=[controller_yaml_tb3_0]),\n\n        Node(\n            namespace='tb3_0',\n            package='nav2_planner',\n            executable='planner_server',\n            name='planner_server',\n            output='screen',\n            parameters=[planner_yaml_tb3_0]),\n\n        Node(\n            namespace='tb3_0',\n            package='nav2_behaviors',\n            executable='behavior_server',\n            name='recoveries_server',\n            parameters=[recovery_yaml_tb3_0],\n            output='screen'),\n\n        Node(\n            namespace='tb3_0',\n            package='nav2_bt_navigator',\n            executable='bt_navigator',\n            name='bt_navigator',\n            output='screen',\n            parameters=[bt_navigator_yaml_tb3_0]),\n\n        # ## TB3_1\n        Node(\n            namespace='tb3_1',\n            package='nav2_controller',\n            executable='controller_server',\n            name='controller_server',\n            output='screen',\n            parameters=[controller_yaml_tb3_1]),\n\n        Node(\n            namespace='tb3_1',\n            package='nav2_planner',\n            executable='planner_server',\n            name='planner_server',\n            output='screen',\n            parameters=[planner_yaml_tb3_1]),\n\n        Node(\n            namespace='tb3_1',\n            package='nav2_behaviors',\n            executable='behavior_server',\n            name='recoveries_server',\n            parameters=[recovery_yaml_tb3_1],\n            output='screen'),\n\n        Node(\n            namespace='tb3_1',\n            package='nav2_bt_navigator',\n            executable='bt_navigator',\n            name='bt_navigator',\n            output='screen',\n            parameters=[bt_navigator_yaml_tb3_1]),\n\n\n        ## LIFECICLE MANAGER\n        Node(\n            package='nav2_lifecycle_manager',\n            executable='lifecycle_manager',\n            name='lifecycle_manager',\n            output='screen',\n\n            parameters=[{'autostart': True},\n                        {'bond_timeout':0.0},\n                        {'node_names': ['tb3_0/controller_server',\n                                        'tb3_0/planner_server',\n                                        'tb3_0/recoveries_server',\n                                        'tb3_0/bt_navigator',\n                                        'tb3_1/controller_server',\n                                        'tb3_1/planner_server',\n                                        'tb3_1/recoveries_server',\n                                        'tb3_1/bt_navigator',\n                                        ]}])\n    ])\n\n"})})]})]}),"\n",(0,s.jsx)(n.admonition,{type:"info",children:(0,s.jsx)(n.p,{children:"The order is localization -> path_planning -> rviz2 for launches."})}),"\n",(0,s.jsx)(n.h3,{id:"configuring-rviz2-1",children:(0,s.jsx)(n.strong,{children:"Configuring RVIZ2"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Add a ",(0,s.jsx)(n.code,{children:"Path"})," display configured for the ",(0,s.jsx)(n.code,{children:"/tb3_0/plan"})," topic and select the ",(0,s.jsx)(n.code,{children:"Line Style"})," as ",(0,s.jsx)(n.code,{children:"Billboards"})," with Red as it's color."]}),"\n",(0,s.jsxs)(n.li,{children:["Add another ",(0,s.jsx)(n.code,{children:"Path"})," for the ",(0,s.jsx)(n.code,{children:"/tb3_1/plan"})," and choose a different color for it."]}),"\n",(0,s.jsxs)(n.li,{children:["Add a ",(0,s.jsx)(n.code,{children:"Map"})," display and configure the topic for the global costmap: ",(0,s.jsx)(n.code,{children:"/tb3_0/global_costmap/costmap"})]}),"\n",(0,s.jsxs)(n.li,{children:["Add another ",(0,s.jsx)(n.code,{children:"Map"})," for ",(0,s.jsx)(n.code,{children:"/tb3_1/global_costmap/costmap"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["Add another ",(0,s.jsx)(n.code,{children:"Map"})," for the ",(0,s.jsx)(n.strong,{children:"local"})," costmap for again each of the topics: ",(0,s.jsx)(n.code,{children:"/tb_3_0/local_costmap/costmap"})," and ",(0,s.jsx)(n.code,{children:"/tb3_1/local_costmap/costmap"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["All the ",(0,s.jsx)(n.code,{children:"cost_maps"})," change the color scheme from ",(0,s.jsx)(n.code,{children:"map"})," to ",(0,s.jsx)(n.code,{children:"cost_map"})," to see the nice colors."]}),"\n",(0,s.jsxs)(n.li,{children:["To make the robot move, use the ",(0,s.jsx)(n.code,{children:"Tool Properties"})," and change the ",(0,s.jsx)(n.code,{children:"2D Goal Pose"})," to be ",(0,s.jsx)(n.code,{children:"/tb3_0/goal_pose"})," and then use the ",(0,s.jsx)(n.code,{children:"2D Goal Pose"}),". For the other robot, use the other namespace ",(0,s.jsx)(n.code,{children:"/tb3_1/goal_pose"}),"."]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"single-launch",children:(0,s.jsx)(n.strong,{children:"Single Launch"})}),"\n",(0,s.jsxs)(n.p,{children:["To make this simpler, we can create several launch files to concentrate everything into a single launch. Inside of our ",(0,s.jsx)(n.code,{children:"path_planner_server"}),", we can create the launch ",(0,s.jsx)(n.code,{children:"multi_main.launch.xml"}),". Inside the ",(0,s.jsx)(n.code,{children:"cartographer_slam"}),", we also create the launch file ",(0,s.jsx)(n.code,{children:"start_rviz.launch.py"})," which'll launch ",(0,s.jsx)(n.code,{children:"RVIZ2"})," without terminal commands. Both of these files should be inside of the ",(0,s.jsx)(n.code,{children:"launch"})," directory."]}),"\n",(0,s.jsxs)(h.A,{children:[(0,s.jsx)(_.A,{label:"multi_main.launch.xml",value:"multi_main.launch.xml",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-xml",children:'<?xml version=\'1.0\' ?>\n\n<launch>\n    <include file="$(find-pkg-share localization)/launch/multi_localization.launch.py"/>\n    <include file="$(find-pkg-share path_planner_server)/launch/multi_pathplanner.launch.py"/>\n\n    <include file="$(find-pkg-share cartographer_slam)/launch/start_rviz.launch.py">\n        <arg name="use_sim_time" value="true"/>\n        <arg name="rviz_config_dir" value="$(find-pkg-share cartographer_slam)/rviz/tb3_1_and_2.rviz" />\n    </include>\n\n</launch>\n'})})}),(0,s.jsx)(_.A,{label:"start_rviz.launch.py",value:"start_rviz.launch.py",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-py",children:"import os\n\nfrom launch import LaunchDescription\nfrom launch.actions import DeclareLaunchArgument\nfrom launch.substitutions import LaunchConfiguration\nfrom launch_ros.actions import Node\n\ndef generate_launch_description():\nuse_sim_time = LaunchConfiguration('use_sim_time', default='false')\nrviz_config_dir = LaunchConfiguration(\"rviz_config_dir\")\n\n    return LaunchDescription([\n\n\n        DeclareLaunchArgument(\n            \"rviz_config_dir\", default_value=\"\", description=\"TRviz\"),\n        DeclareLaunchArgument(\n            'use_sim_time',\n            default_value='false',\n            description='Use simulation (Gazebo) clock if true'),\n\n        Node(\n            package='rviz2',\n            executable='rviz2',\n            name='rviz2',\n            arguments=['-d', rviz_config_dir],\n            parameters=[{'use_sim_time': use_sim_time}],\n            output='screen'),\n    ])\n\n"})})})]}),"\n",(0,s.jsx)(n.p,{children:"Then launch via:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"ros2 launch path_planner_server multi_main.launch.xml\n"})}),"\n",(0,s.jsx)("video",{width:"100%",controls:!0,src:b,title:"MultiPath Agents Video"})]})}function B(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(H,{...e})}):H(e)}},2083:(e,n,a)=>{"use strict";a.d(n,{A0:()=>i,BF:()=>l,Hj:()=>c,XI:()=>t,nA:()=>h,nd:()=>d,r6:()=>_});var r=a(6540),s=a(2552),o=a(4848);const t=r.forwardRef(((e,n)=>{let{className:a,...r}=e;return(0,o.jsx)("div",{className:"relative w-full overflow-auto",children:(0,o.jsx)("table",{ref:n,className:(0,s.cn)("w-full caption-bottom text-sm",a),...r})})}));t.displayName="Table";const i=r.forwardRef(((e,n)=>{let{className:a,...r}=e;return(0,o.jsx)("thead",{ref:n,className:(0,s.cn)("[&_tr]:border-b",a),...r})}));i.displayName="TableHeader";const l=r.forwardRef(((e,n)=>{let{className:a,...r}=e;return(0,o.jsx)("tbody",{ref:n,className:(0,s.cn)("[&_tr:last-child]:border-0",a),...r})}));l.displayName="TableBody";r.forwardRef(((e,n)=>{let{className:a,...r}=e;return(0,o.jsx)("tfoot",{ref:n,className:(0,s.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",a),...r})})).displayName="TableFooter";const c=r.forwardRef(((e,n)=>{let{className:a,...r}=e;return(0,o.jsx)("tr",{ref:n,className:(0,s.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",a),...r})}));c.displayName="TableRow";const d=r.forwardRef(((e,n)=>{let{className:a,...r}=e;return(0,o.jsx)("th",{ref:n,className:(0,s.cn)("h-10 px-2 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",a),...r})}));d.displayName="TableHead";const h=r.forwardRef(((e,n)=>{let{className:a,...r}=e;return(0,o.jsx)("td",{ref:n,className:(0,s.cn)("p-2 align-middle [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",a),...r})}));h.displayName="TableCell";const _=r.forwardRef(((e,n)=>{let{className:a,...r}=e;return(0,o.jsx)("caption",{ref:n,className:(0,s.cn)("mt-4 text-sm text-muted-foreground",a),...r})}));_.displayName="TableCaption"},2552:(e,n,a)=>{"use strict";a.d(n,{cn:()=>o});var r=a(4164),s=a(856);function o(){for(var e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];return(0,s.QP)((0,r.$)(n))}}}]);